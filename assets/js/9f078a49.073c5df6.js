"use strict";(self.webpackChunkwasmx_docs=self.webpackChunkwasmx_docs||[]).push([[5817],{5309:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>t,contentTitle:()=>l,default:()=>h,frontMatter:()=>a,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"architecture/email","title":"Email Verification Protocols","description":"Email Verification Protocols (SPF, DKIM, DMARC, ARC)","source":"@site/docs/architecture/email.md","sourceDirName":"architecture","slug":"/architecture/email","permalink":"/docs/architecture/email","draft":false,"unlisted":false,"editUrl":"https://github.com/loredanacirstea/wasmx-docs/tree/main/docs/architecture/email.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2,"title":"Email Verification Protocols","description":"Email Verification Protocols (SPF, DKIM, DMARC, ARC)","image":"/img/email1.png","keywords":["SPF","DKIM","DMARC","ARC","email","Sender Policy Framework","DomainKeys Identified Mail","Domain-based Message Authentication","Authenticated Received Chain","cryptography"]},"sidebar":"tutorialSidebar","previous":{"title":"Provable Email Forwarding","permalink":"/docs/architecture/provable_email_forwarding"}}');var d=i(4848),s=i(8453);const a={sidebar_position:2,title:"Email Verification Protocols",description:"Email Verification Protocols (SPF, DKIM, DMARC, ARC)",image:"/img/email1.png",keywords:["SPF","DKIM","DMARC","ARC","email","Sender Policy Framework","DomainKeys Identified Mail","Domain-based Message Authentication","Authenticated Received Chain","cryptography"]},l="Email Verification Protocols Now",t={},c=[{value:"SPF (Sender Policy Framework)",id:"spf-sender-policy-framework",level:2},{value:"DKIM (DomainKeys Identified Mail)",id:"dkim-domainkeys-identified-mail",level:2},{value:"Required DKIM Signature Tags",id:"required-dkim-signature-tags",level:3},{value:"Optional DKIM Signature Tags",id:"optional-dkim-signature-tags",level:3},{value:"<code>h=</code> signed headers",id:"h-signed-headers",level:3},{value:"DMARC (Domain-based Message Authentication, Reporting and Conformance)",id:"dmarc-domain-based-message-authentication-reporting-and-conformance",level:2},{value:"Flow",id:"flow",level:3},{value:"ARC (Authenticated Received Chain)",id:"arc-authenticated-received-chain",level:2},{value:"Flow",id:"flow-1",level:3},{value:"ARC-Authentication-Results",id:"arc-authentication-results",level:3},{value:"Common Methods and Fields",id:"common-methods-and-fields",level:4},{value:"Possible Results (for each method):",id:"possible-results-for-each-method",level:4},{value:"ARC-Message-Signature",id:"arc-message-signature",level:3},{value:"<code>h=</code> signed headers",id:"h-signed-headers-1",level:3},{value:"ARC-Seal",id:"arc-seal",level:3},{value:"CV",id:"cv",level:4},{value:"Headers",id:"headers",level:2},{value:"<code>From</code>",id:"from",level:3},{value:"<code>To</code>",id:"to",level:3},{value:"<code>Subject</code>",id:"subject",level:3},{value:"<code>Date</code>",id:"date",level:3},{value:"<code>Message-ID</code>",id:"message-id",level:3},{value:"<code>Reply-To</code>",id:"reply-to",level:3},{value:"<code>Sender</code>",id:"sender",level:3},{value:"<code>MIME-Version</code>",id:"mime-version",level:3},{value:"<code>Content-Type</code>",id:"content-type",level:3},{value:"<code>Content-Transfer-Encoding</code>",id:"content-transfer-encoding",level:3},{value:"<code>Delivered-To</code>",id:"delivered-to",level:3},{value:"<code>Received</code>",id:"received",level:3},{value:"<code>Return-Path</code>",id:"return-path",level:3},{value:"<code>Received-SPF</code>",id:"received-spf",level:3},{value:"<code>Authentication-Results</code>",id:"authentication-results",level:3},{value:"<code>DKIM-Signature</code>",id:"dkim-signature",level:3},{value:"<code>ARC-Seal</code>",id:"arc-seal-1",level:3},{value:"<code>ARC-Message-Signature</code>",id:"arc-message-signature-1",level:3},{value:"<code>ARC-Authentication-Results</code>",id:"arc-authentication-results-1",level:3},{value:"Envelope",id:"envelope",level:2},{value:"Sending an Email",id:"sending-an-email",level:2},{value:"Automatic Forwarding with ARC support",id:"automatic-forwarding-with-arc-support",level:2},{value:"Unchanged Headers",id:"unchanged-headers",level:3},{value:"Added Headers",id:"added-headers",level:3},{value:"Example: Gmail automatic (server-side) forwarding with ARC support",id:"example-gmail-automatic-server-side-forwarding-with-arc-support",level:3},{value:"Manual Forwarding",id:"manual-forwarding",level:2},{value:"Changed Headers",id:"changed-headers",level:3},{value:"Added Headers by Receiving MTA",id:"added-headers-by-receiving-mta",level:3},{value:"Original Email Information in the Forwarded Email",id:"original-email-information-in-the-forwarded-email",level:3},{value:"Example: Gmail manual forward",id:"example-gmail-manual-forward",level:3}];function o(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(n.header,{children:(0,d.jsx)(n.h1,{id:"email-verification-protocols-now",children:"Email Verification Protocols Now"})}),"\n",(0,d.jsx)(n.h2,{id:"spf-sender-policy-framework",children:"SPF (Sender Policy Framework)"}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/html/rfc7208",children:"https://datatracker.ietf.org/doc/html/rfc7208"})}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"MAILFROM"})," set by SMTP email sender"]}),"\n",(0,d.jsx)(n.li,{children:(0,d.jsx)(n.code,{children:"IP"})}),"\n"]}),"\n",(0,d.jsxs)(n.p,{children:["SMTP email receiver queries the SPF record for the ",(0,d.jsx)(n.code,{children:"MAIL FROM"})," domain and checks that ",(0,d.jsx)(n.code,{children:"IP"})," is authorized."]}),"\n",(0,d.jsxs)(n.p,{children:["SPF record example for ",(0,d.jsx)(n.a,{href:"https://dns.google/resolve?type=TXT&name=mail.provable.dev",children:"mail.provable.dev"})]}),"\n",(0,d.jsx)(n.h2,{id:"dkim-domainkeys-identified-mail",children:"DKIM (DomainKeys Identified Mail)"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:(0,d.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/html/rfc6376",children:"https://datatracker.ietf.org/doc/html/rfc6376"})}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"required-dkim-signature-tags",children:"Required DKIM Signature Tags"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Tag"}),(0,d.jsx)(n.th,{children:"Name"}),(0,d.jsx)(n.th,{children:"Description"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"v"})}),(0,d.jsx)(n.td,{children:"Version"}),(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"1"})," for rfc6376"]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"a"})}),(0,d.jsx)(n.td,{children:"Algorithm"}),(0,d.jsxs)(n.td,{children:["The cryptographic algorithm used to generate the signature, e.g. ",(0,d.jsx)(n.code,{children:"rsa-sha256"})," or ",(0,d.jsx)(n.code,{children:"ed25519-sha256"}),"."]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"b"})}),(0,d.jsx)(n.td,{children:"Signature"}),(0,d.jsx)(n.td,{children:"The actual Base64-encoded digital signature (generated using the private key)."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"bh"})}),(0,d.jsx)(n.td,{children:"Body Hash"}),(0,d.jsx)(n.td,{children:"Base64-encoded hash of the canonicalized body; used to verify the body wasn't modified."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"d"})}),(0,d.jsx)(n.td,{children:"Domain"}),(0,d.jsxs)(n.td,{children:["SDID: the signing domain (",(0,d.jsx)(n.code,{children:"d="}),") whose DNS contains the public key under ",(0,d.jsx)(n.code,{children:"selector._domainkey.domain"})," (e.g. ",(0,d.jsx)(n.a,{href:"https://dns.google/resolve?type=TXT&name=2024a._domainkey.mail.provable.dev",children:"2024a._domainkey.mail.provable.dev"}),")"]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"h"})}),(0,d.jsx)(n.td,{children:"Signed Headers"}),(0,d.jsxs)(n.td,{children:["A colon-separated list of headers that were signed (in order), e.g. ",(0,d.jsx)(n.code,{children:"from:to:subject"}),"."]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"s"})}),(0,d.jsx)(n.td,{children:"Selector"}),(0,d.jsxs)(n.td,{children:["Indicates the DNS record selector under ",(0,d.jsx)(n.code,{children:"_domainkey"}),", e.g. ",(0,d.jsx)(n.code,{children:"s=2024a"})," \u2192 ",(0,d.jsx)(n.code,{children:"2024a._domainkey.mail.provable.dev"})," (e.g. ",(0,d.jsx)(n.a,{href:"https://dns.google/resolve?type=TXT&name=2024a._domainkey.mail.provable.dev",children:"2024a._domainkey.mail.provable.dev"}),"."]})]})]})]}),"\n",(0,d.jsx)(n.h3,{id:"optional-dkim-signature-tags",children:"Optional DKIM Signature Tags"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Tag"}),(0,d.jsx)(n.th,{children:"Name"}),(0,d.jsx)(n.th,{children:"Description"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"c"})}),(0,d.jsx)(n.td,{children:"Canonicalization Algorithm"}),(0,d.jsxs)(n.td,{children:["Header/body canonicalization, e.g. ",(0,d.jsx)(n.code,{children:"relaxed/relaxed"}),", ",(0,d.jsx)(n.code,{children:"simple/simple"}),". Default is ",(0,d.jsx)(n.code,{children:"simple/simple"}),"."]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"i"})}),(0,d.jsx)(n.td,{children:"Identity"}),(0,d.jsxs)(n.td,{children:["AUID (User identifier), e.g. ",(0,d.jsx)(n.code,{children:"i=@example.com"})," or ",(0,d.jsx)(n.code,{children:"i=user@example.com"}),". Must be a subdomain or exact match of ",(0,d.jsx)(n.code,{children:"d="}),"."]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"l"})}),(0,d.jsx)(n.td,{children:"Body Length Count"}),(0,d.jsx)(n.td,{children:"Number of body bytes hashed (used for partial signing). Rarely used."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"q"})}),(0,d.jsx)(n.td,{children:"Query Method"}),(0,d.jsxs)(n.td,{children:["How to retrieve the public key. Usually just ",(0,d.jsx)(n.code,{children:"dns/txt"}),". Deprecated and ignored by most systems."]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"t"})}),(0,d.jsx)(n.td,{children:"Timestamp"}),(0,d.jsx)(n.td,{children:"Integer (Unix timestamp) when the signature was created."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"x"})}),(0,d.jsx)(n.td,{children:"Expiration"}),(0,d.jsx)(n.td,{children:"Integer (Unix timestamp) after which the signature is no longer valid."})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"z"})}),(0,d.jsx)(n.td,{children:"Copied Headers"}),(0,d.jsx)(n.td,{children:"Original headers (folded) to aid debugging; optional and rarely used."})]})]})]}),"\n",(0,d.jsxs)(n.h3,{id:"h-signed-headers",children:[(0,d.jsx)(n.code,{children:"h="})," signed headers"]}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["required: ",(0,d.jsx)(n.code,{children:"From"})]}),"\n",(0,d.jsxs)(n.li,{children:["recommended: ",(0,d.jsx)(n.code,{children:"From:To:Cc:Subject:Date:Message-ID:Content-Type:Content-Transfer-Encoding"})]}),"\n"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-email",children:"DKIM-Signature: v=1;\n  d=mail.provable.dev;\n  s=2024a;\n  i=test@mail.provable.dev;\n  a=ed25519-sha256;\n  t=1749589922;\n  x=1749849122;\n  h=From:To:Cc:Bcc:Reply-To: References:In-Reply-To:Subject:Date:Message-Id:Content-Type:From:To:Subject: Date:Message-Id:Content-Type;\n  bh=4fWAjR8dybJoJ7oc+ua358Qnylv7LASFrox6UiJwQ8g=;\n  b=7J39El5KDL4NPguv2fK3m7xm/F\n    evJN9QFqECm90XGwfWnlqBEEjHteY/P28AJ5xwfenf08TdtBLIMes6PMZTBA==\nDKIM-Signature: v=1;\n  d=mail.provable.dev;\n  s=2024b;\n  i=test@mail.provable.dev;\n  a=rsa-sha256;\n  t=1749589922;\n  x=1749849122;\n  h=From:To:Cc:Bcc:Reply-To: References:In-Reply-To:Subject:Date:Message-Id:Content-Type:From:To:Subject: Date:Message-Id:Content-Type;\n  bh=4fWAjR8dybJoJ7oc+ua358Qnylv7LASFrox6UiJwQ8g=;\n  b=K043WB+2sby57d3sihT+xRSou8\n    H2+XTKqUxrfBRaOa6q48hcUs7DVg9n+0bA6T7cAQYlNsc1MNoViH5ebdjYKigJepnwrh4CCGweJUZ\n    plhBWUF2McU4Kgz8XaLyCt5ipots2aOLRG7yT0FkudXYBY2bnG64fbyQABf6LClIF9Gwuq8gNF5Mj\n    YF+oZZCZdnsQnf/AT+qDYCjOgTbjoPosZDOypsHSu42/m12UsYEqAZsBrsqaFV1rmFLlpdWzQ8y41\n    dySACyWpRiVayzU5vFvfBkd/juhG94xlER9cs8RLE/oeFXqtOqq21HDUfqLp3koxqOeHTgmctN/0r\n    BI+nuopA==\n"})}),"\n",(0,d.jsx)(n.p,{children:"Allows the sender's mail server to digitally sign email messages using their domain's private key. The recipient\u2019s mail server can then verify the signature using the public key published in DNS, ensuring:"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"The email was not altered in transit."}),"\n",(0,d.jsx)(n.li,{children:"It was authorized by the domain it claims to be from."}),"\n"]}),"\n",(0,d.jsx)(n.h2,{id:"dmarc-domain-based-message-authentication-reporting-and-conformance",children:"DMARC (Domain-based Message Authentication, Reporting and Conformance)"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:(0,d.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/html/rfc7489",children:"https://datatracker.ietf.org/doc/html/rfc7489"})}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"flow",children:"Flow"}),"\n",(0,d.jsx)(n.mermaid,{value:"flowchart TB\n  A[Start] --\x3e B{Domains match}\n  B --\x3e|Yes| C[SPF check]\n  B --\x3e|No| D[FAIL]\n  C --\x3e|Yes| F[PASS]\n  C --\x3e|No| E[DKIM check]\n  E --\x3e|Yes| F[PASS]\n  E --\x3e|No| D[FAIL]"}),"\n",(0,d.jsxs)(n.ol,{children:["\n",(0,d.jsxs)(n.li,{children:["Check ",(0,d.jsx)(n.a,{href:"#dkim-domainkeys-identified-mail",children:"DKIM signature"})]}),"\n",(0,d.jsxs)(n.li,{children:["Check ",(0,d.jsx)(n.a,{href:"#spf-sender-policy-framework",children:"SPF"})]}),"\n",(0,d.jsxs)(n.li,{children:["Check alignment (*required). Domains must match:","\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.a,{href:"#from",children:(0,d.jsx)(n.code,{children:"header.From"})})," domain"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.a,{href:"#dkim-domainkeys-identified-mail",children:"DKIM"})," ",(0,d.jsx)(n.code,{children:"d="})," domain"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.a,{href:"#spf-sender-policy-framework",children:"SPF"})," ",(0,d.jsx)(n.code,{children:"MAILFROM"})," domain"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,d.jsx)(n.p,{children:"If alignment (3) + one of SPF (2) or DKIM (1) passes \u2192 DMARC passes"}),"\n",(0,d.jsx)(n.h2,{id:"arc-authenticated-received-chain",children:"ARC (Authenticated Received Chain)"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:(0,d.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/html/rfc8617",children:"https://datatracker.ietf.org/doc/html/rfc8617"})}),"\n",(0,d.jsx)(n.li,{children:(0,d.jsx)(n.a,{href:"https://arc-spec.org/",children:"https://arc-spec.org/"})}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"flow-1",children:"Flow"}),"\n",(0,d.jsx)(n.p,{children:"Preserves the results of email authentication checks (SPF, DKIM, DMARC) as a message passes through intermediaries (like mailing lists or forwarders) that might otherwise break those checks \u2014 enabling the final recipient to make informed trust decisions even if the message has been modified."}),"\n",(0,d.jsx)(n.mermaid,{value:"flowchart TD\n  A[Sender sends message with SPF/DKIM/DMARC] --\x3e B[ARC-Aware Intermediary receives message]\n  B --\x3e C[Verify DKIM/SPF/DMARC]\n  C --\x3e D[Add ARC-Authentication-Results AAR]\n  D --\x3e E[Add ARC-Message-Signature AMS]\n  E --\x3e F[Seal AAR + AMS + previous ARC-Seals with ARC-Seal]\n  F --\x3e G[Forward message with updated ARC headers]\n  G --\x3e H[Recipient receives message]\n  H --\x3e I[Verify all ARC-Seals in chain]\n  I --\x3e J{All ARC-Seals valid?}\n  J -- Yes --\x3e K[Use ARC-Authentication-Results for policy decisions]\n  J -- No --\x3e L[Reject/ignore authentication chain]\n\n style A fill:#e0f7fa,stroke:#00796b,stroke-width:2px\n style B fill:#fff9c4,stroke:#fbc02d,stroke-width:2px\n style G fill:#fff9c4,stroke:#fbc02d,stroke-width:2px\n style H fill:#e1bee7,stroke:#7b1fa2,stroke-width:2px\n style K fill:#c8e6c9,stroke:#388e3c,stroke-width:2px\n style L fill:#ffcdd2,stroke:#d32f2f,stroke-width:2px"}),"\n",(0,d.jsx)(n.h3,{id:"arc-authentication-results",children:"ARC-Authentication-Results"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:(0,d.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/html/rfc8617#section-4.1.1",children:"https://datatracker.ietf.org/doc/html/rfc8617#section-4.1.1"})}),"\n"]}),"\n",(0,d.jsxs)(n.p,{children:["General syntax: ",(0,d.jsx)(n.code,{children:"method = result (comment) [ kv-pairs ]"})]}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"method"}),": e.g., dkim, spf, dmarc"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"result"}),": one of the defined values"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"comment"}),": optional human-readable info"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"kv-pairs"}),": optional, like header.i=..."]}),"\n"]}),"\n",(0,d.jsx)(n.h4,{id:"common-methods-and-fields",children:"Common Methods and Fields"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Method"}),(0,d.jsx)(n.th,{children:"Meaning"}),(0,d.jsx)(n.th,{children:"Example"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"dkim"})}),(0,d.jsx)(n.td,{children:"DKIM signature validation result"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"dkim=pass header.i=@example.com"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"spf"})}),(0,d.jsx)(n.td,{children:"SPF result for SMTP envelope sender"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"spf=fail smtp.mailfrom=bad.example.com"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"dmarc"})}),(0,d.jsx)(n.td,{children:"DMARC result (based on SPF & DKIM alignment)"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"dmarc=pass header.from=example.com"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"arc"})}),(0,d.jsx)(n.td,{children:"ARC chain validation result"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"arc=pass (i=1 spf=pass dkim=pass dmarc=pass)"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"iprev"})}),(0,d.jsx)(n.td,{children:"Reverse DNS validation"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"iprev=pass policy.iprev=203.0.113.1"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"auth"})}),(0,d.jsx)(n.td,{children:"Authentication status"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"auth=pass smtp.auth=user@example.com"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"smtp.mailfrom"})}),(0,d.jsxs)(n.td,{children:["The domain in the ",(0,d.jsx)(n.code,{children:"MAIL FROM"})," envelope"]}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"smtp.mailfrom=example.com"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"header.from"})}),(0,d.jsxs)(n.td,{children:["The domain in the ",(0,d.jsx)(n.code,{children:"From:"})," header"]}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"header.from=example.com"})})]})]})]}),"\n",(0,d.jsx)(n.h4,{id:"possible-results-for-each-method",children:"Possible Results (for each method):"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Result"}),(0,d.jsx)(n.th,{children:"Meaning"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"pass"})}),(0,d.jsx)(n.td,{children:"Authentication succeeded"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"fail"})}),(0,d.jsx)(n.td,{children:"Authentication failed"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"neutral"})}),(0,d.jsx)(n.td,{children:"Indeterminate / ambiguous result"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"none"})}),(0,d.jsx)(n.td,{children:"No data / method not applied"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"temperror"})}),(0,d.jsx)(n.td,{children:"Temporary error"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"permerror"})}),(0,d.jsx)(n.td,{children:"Permanent error (e.g., malformed DNS)"})]})]})]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-email",children:'ARC-Authentication-Results: i=3; mx.google.com;\n    dkim=neutral (no key) header.i=@mail.provable.dev header.s=2024a;\n    dkim=pass header.i=@mail.provable.dev header.s=2024b header.b=K043WB+2;\n    arc=pass (i=2 spf=pass spfdomain=mail.provable.dev dkim=pass dkdomain=mail.provable.dev dmarc=pass fromdomain=mail.provable.dev);\n    spf=pass (google.com: domain of thelaurel.bot+caf_=seth.one.info=gmail.com@gmail.com designates 209.85.220.41 as permitted sender) smtp.mailfrom="thelaurel.bot+caf_=seth.one.info=gmail.com@gmail.com";\n    dmarc=pass (p=REJECT sp=REJECT dis=NONE) header.from=mail.provable.dev;\n    dara=pass header.i=@gmail.com\n'})}),"\n",(0,d.jsx)(n.h3,{id:"arc-message-signature",children:"ARC-Message-Signature"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:(0,d.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/html/rfc8617#section-4.1.2",children:"https://datatracker.ietf.org/doc/html/rfc8617#section-4.1.2"})}),"\n"]}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Field"}),(0,d.jsx)(n.th,{children:"Description"}),(0,d.jsx)(n.th,{children:"Example"}),(0,d.jsx)(n.th,{children:"Required"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"i"})}),(0,d.jsx)(n.td,{children:"ARC instance number. Must match corresponding ARC-Seal and ARC-Authentication-Results headers."}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"i=1"})}),(0,d.jsx)(n.td,{children:"Yes"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"a"})}),(0,d.jsx)(n.td,{children:"Signing algorithm used. Typically RSA or Ed25519 with a hash function."}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"a=rsa-sha256"})}),(0,d.jsx)(n.td,{children:"Yes"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"c"})}),(0,d.jsx)(n.td,{children:"Canonicalization algorithm for headers/body."}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"c=relaxed/relaxed"})}),(0,d.jsxs)(n.td,{children:["No (default: ",(0,d.jsx)(n.code,{children:"simple/simple"}),")"]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"d"})}),(0,d.jsx)(n.td,{children:"Domain of the signer (signing domain)."}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"d=example.org"})}),(0,d.jsx)(n.td,{children:"Yes"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"s"})}),(0,d.jsx)(n.td,{children:"Selector used to locate the public key in DNS."}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"s=brisbane"})}),(0,d.jsx)(n.td,{children:"Yes"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"t"})}),(0,d.jsx)(n.td,{children:"Signing timestamp (Unix seconds since epoch)."}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"t=1610000000"})}),(0,d.jsx)(n.td,{children:"No"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"h"})}),(0,d.jsx)(n.td,{children:"List of signed headers, in the order they were signed."}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"h=from:to:subject:date"})}),(0,d.jsx)(n.td,{children:"Yes"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"bh"})}),(0,d.jsx)(n.td,{children:"Body hash (base64 of hash of canonicalized body)."}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"bh=abcdefg...="})}),(0,d.jsx)(n.td,{children:"Yes"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"b"})}),(0,d.jsxs)(n.td,{children:["Signature itself (base64). Must be empty (",(0,d.jsx)(n.code,{children:"b="}),") at time of signing."]}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"b=abc123..."})}),(0,d.jsx)(n.td,{children:"Yes"})]})]})]}),"\n",(0,d.jsxs)(n.h3,{id:"h-signed-headers-1",children:[(0,d.jsx)(n.code,{children:"h="})," signed headers"]}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["required: ",(0,d.jsx)(n.code,{children:"From"})]}),"\n",(0,d.jsxs)(n.li,{children:["recommended: cover sender's DKIM signature context; e.g. ",(0,d.jsx)(n.code,{children:"From:To:Subject:Date:Message-ID:DKIM-Signature:Content-Type:Content-Transfer-Encoding:MIME-Version"})]}),"\n"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-email",children:"ARC-Message-Signature: i=3;\n    a=rsa-sha256;\n    c=relaxed/relaxed;\n    d=google.com;\n    s=arc-20240605;\n    h=content-transfer-encoding:mime-version:user-agent:date:message-id\n        :subject:to:from:dkim-signature:dkim-signature:delivered-to;\n    bh=4fWAjR8dybJoJ7oc+ua358Qnylv7LASFrox6UiJwQ8g=;\n    fh=Ml91QZNjOUBF4lPxdodEISvnG8cKMzALenqeNxoWqdI=;\n    b=VEGNq275dIibd6+54GYZnP2dIHqFiGkAwALj/FA4hw7weJGTiFvfcb/O7p20PPWbUY\n        isM3m4twYpknpID3hRN/euJJNWqj4VgclnJST3nQ+F0WgfwBCOl/wuVJbu9pO9vgJAY7\n        WglNuiona7FL0Rlwp+KGHllLbR5CA0pak3s9E+OI3fhZya9/v5Gldis8vzsyfOiCnGta\n        5IYVB42Mgdi+tS2SaUaHqPUL+g9eo2hnca56CTkEieuOZcLFDcCOHQTZol4n8ti5aiiI\n        UB2EKnu+PC1JX7Tm2MYYBbIRZhuB9OF2TQat13rr8Hph3I1/cupScIWFRr/8Hkh4PP0q\n        9kUw==;\n    dara=google.com\n"})}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["cryptographically similar to ",(0,d.jsx)(n.code,{children:"DKIM-Signature"}),", but the signed content has some differences."]}),"\n"]}),"\n",(0,d.jsx)(n.p,{children:"Captures and cryptographically preserves the message\u2019s authentication state (headers and body) as received by an intermediate system (like a forwarder or mailing list), before it modifies or relays the message."}),"\n",(0,d.jsx)(n.h3,{id:"arc-seal",children:"ARC-Seal"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:(0,d.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/html/rfc8617#section-4.1.3",children:"https://datatracker.ietf.org/doc/html/rfc8617#section-4.1.3"})}),"\n"]}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Field"}),(0,d.jsx)(n.th,{children:"Description"}),(0,d.jsx)(n.th,{children:"Example"}),(0,d.jsx)(n.th,{children:"Required"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"i"})}),(0,d.jsxs)(n.td,{children:["ARC instance number. Must match the corresponding ",(0,d.jsx)(n.code,{children:"i="})," in ARC-Authentication-Results and ARC-Message-Signature."]}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"i=1"})}),(0,d.jsx)(n.td,{children:"Yes"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"a"})}),(0,d.jsxs)(n.td,{children:["Algorithm used to generate the signature. Format: ",(0,d.jsx)(n.code,{children:"<algorithm>-<hash>"}),"."]}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"a=rsa-sha256"})}),(0,d.jsx)(n.td,{children:"Yes"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"d"})}),(0,d.jsxs)(n.td,{children:["Domain of the sealing entity (signer). Used with ",(0,d.jsx)(n.code,{children:"s="})," to retrieve the public key."]}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"d=example.org"})}),(0,d.jsx)(n.td,{children:"Yes"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"s"})}),(0,d.jsx)(n.td,{children:"Selector used to locate the public key in DNS."}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"s=selector1"})}),(0,d.jsx)(n.td,{children:"Yes"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"t"})}),(0,d.jsx)(n.td,{children:"Signing timestamp (seconds since epoch)."}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"t=1650000000"})}),(0,d.jsx)(n.td,{children:"Yes"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"cv"})}),(0,d.jsxs)(n.td,{children:["Chain validation result for previous ARC sets. Values: ",(0,d.jsx)(n.code,{children:"none"}),", ",(0,d.jsx)(n.code,{children:"pass"}),", or ",(0,d.jsx)(n.code,{children:"fail"}),"."]}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"cv=none"})}),(0,d.jsx)(n.td,{children:"Yes"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"b"})}),(0,d.jsxs)(n.td,{children:["Signature value (base64-encoded). Empty (",(0,d.jsx)(n.code,{children:"b="}),") when computing the hash."]}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"b=abc123..."})}),(0,d.jsx)(n.td,{children:"Yes"})]})]})]}),"\n",(0,d.jsx)(n.h4,{id:"cv",children:"CV"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Result"}),(0,d.jsx)(n.th,{children:"Description"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"none"}),(0,d.jsx)(n.td,{children:"this is the first ARC set (i=1)"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"pass"}),(0,d.jsx)(n.td,{children:"all previous ARC sets validated"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"fail"}),(0,d.jsx)(n.td,{children:"if any prior ARC set failed"})]})]})]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-email",children:"ARC-Seal: i=3;\n    a=rsa-sha256;\n    t=1749589924;\n    cv=pass;\n    d=google.com;\n    s=arc-20240605;\n    b=k/DDEvhaKSwq1fjWM0FrkW5lbFEVRHln8sdi0ExNdxC5DX2e6Wcc+yDxxesyjpccS/\n        H8f5Ii2NnZShlTB37lgzP0s8knWd0sLnqorv/EM9DaCU/jRPwcPN51k4TOdMZqxzCzUy\n        MHPNZzTN1o4XomdeC2EP2gw90XdaYhzTlmwR6F4uRdU42uPTPfAxHQp7muQSqez8ptF+\n        GC641X6SE9SrCMNdakyj14W85fhc6rRvTzf8itaD1Rl3W3BoYjulSGVoRSYWS16He3uT\n        l6YR7/0sc0tAKKhLYdkwesc81qo65crK6Qc/4F3Xq1iS88+kDc9kqizrg0lT++PNfFgO\n        BC0w==\n"})}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"the canonicalization for ARC-Seal is always relaxed (c= is not specified)."}),"\n",(0,d.jsxs)(n.li,{children:["ARC-Seal signs over:","\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"the current ARC-Authentication-Results"}),"\n",(0,d.jsx)(n.li,{children:"the current ARC-Message-Signature"}),"\n",(0,d.jsx)(n.li,{children:"all prior ARC-Seals (not including the current one)"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,d.jsx)(n.h2,{id:"headers",children:"Headers"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"topmost headers are most recent"}),"\n",(0,d.jsx)(n.li,{children:(0,d.jsx)(n.a,{href:"https://www.iana.org/assignments/message-headers/message-headers.xhtml",children:"https://www.iana.org/assignments/message-headers/message-headers.xhtml"})}),"\n",(0,d.jsxs)(n.li,{children:["header formatting: ",(0,d.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/html/rfc5322#section-2.2.3",children:"https://datatracker.ietf.org/doc/html/rfc5322#section-2.2.3"})," (Long header fields folding)"]}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"from",children:(0,d.jsx)(n.code,{children:"From"})}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["RFC: ",(0,d.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/html/rfc5322",children:"RFC 5322"})]}),"\n",(0,d.jsx)(n.li,{children:"Purpose: Specifies the author of the message (the visible sender)."}),"\n",(0,d.jsx)(n.li,{children:"Set by: Mail User Agent (MUA) or sender."}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"to",children:(0,d.jsx)(n.code,{children:"To"})}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["RFC: ",(0,d.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/html/rfc5322",children:"RFC 5322"})]}),"\n",(0,d.jsx)(n.li,{children:"Purpose: Specifies the primary recipient(s) of the message."}),"\n",(0,d.jsx)(n.li,{children:"Set by: Sender or email client."}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"subject",children:(0,d.jsx)(n.code,{children:"Subject"})}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["RFC: ",(0,d.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/html/rfc5322",children:"RFC 5322"})]}),"\n",(0,d.jsx)(n.li,{children:"Purpose: Provides a summary or title of the message content."}),"\n",(0,d.jsx)(n.li,{children:"Set by: Sender."}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"date",children:(0,d.jsx)(n.code,{children:"Date"})}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["RFC: ",(0,d.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/html/rfc5322",children:"RFC 5322"})]}),"\n",(0,d.jsx)(n.li,{children:"Purpose: Indicates the date and time at which the message was composed."}),"\n",(0,d.jsx)(n.li,{children:"Set by: Sending mail client."}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"message-id",children:(0,d.jsx)(n.code,{children:"Message-ID"})}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["RFC: ",(0,d.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/html/rfc5322",children:"RFC 5322"})]}),"\n",(0,d.jsx)(n.li,{children:"Purpose: Provides a unique identifier for the message for threading and deduplication."}),"\n",(0,d.jsx)(n.li,{children:"Set by: Sending MUA or mail server."}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"reply-to",children:(0,d.jsx)(n.code,{children:"Reply-To"})}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["RFC: ",(0,d.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/html/rfc5322",children:"RFC 5322"})]}),"\n",(0,d.jsx)(n.li,{children:"Purpose: Indicates an alternate address for replies."}),"\n",(0,d.jsx)(n.li,{children:"Set by: Sender."}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"sender",children:(0,d.jsx)(n.code,{children:"Sender"})}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["RFC: ",(0,d.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/html/rfc5322",children:"RFC 5322"})]}),"\n",(0,d.jsx)(n.li,{children:"Purpose: Identifies the actual sender when From is a group or different role."}),"\n",(0,d.jsx)(n.li,{children:"Set by: Sender."}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"mime-version",children:(0,d.jsx)(n.code,{children:"MIME-Version"})}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["RFC: ",(0,d.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/html/rfc2045",children:"RFC 2045"})]}),"\n",(0,d.jsx)(n.li,{children:"Purpose: Indicates that the message uses MIME formatting."}),"\n",(0,d.jsx)(n.li,{children:"Set by: Mail client."}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"content-type",children:(0,d.jsx)(n.code,{children:"Content-Type"})}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["RFC: ",(0,d.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/html/rfc2045",children:"RFC 2045"})]}),"\n",(0,d.jsx)(n.li,{children:"Purpose: Specifies the media type of the message body (e.g., text/plain, multipart)."}),"\n",(0,d.jsx)(n.li,{children:"Set by: Mail client."}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"content-transfer-encoding",children:(0,d.jsx)(n.code,{children:"Content-Transfer-Encoding"})}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["RFC: ",(0,d.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/html/rfc2045",children:"RFC 2045"})]}),"\n",(0,d.jsx)(n.li,{children:"Purpose: Indicates encoding used for the body content (e.g., base64, quoted-printable)."}),"\n",(0,d.jsx)(n.li,{children:"Set by: Mail client."}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"delivered-to",children:(0,d.jsx)(n.code,{children:"Delivered-To"})}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"RFC: Not standardized in an RFC, but widely used."}),"\n",(0,d.jsx)(n.li,{children:"Purpose: Indicates the final mailbox address where the message was delivered."}),"\n",(0,d.jsx)(n.li,{children:"Set by: The receiving mail server."}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"received",children:(0,d.jsx)(n.code,{children:"Received"})}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["RFC: ",(0,d.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/html/rfc5321",children:"https://datatracker.ietf.org/doc/html/rfc5321"}),", ",(0,d.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/html/rfc5322",children:"https://datatracker.ietf.org/doc/html/rfc5322"})]}),"\n",(0,d.jsx)(n.li,{children:"Purpose: Tracks the path an email took from the sender to the recipient by listing each mail server that processed it."}),"\n",(0,d.jsx)(n.li,{children:"Set by: Each mail server in the delivery chain."}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"return-path",children:(0,d.jsx)(n.code,{children:"Return-Path"})}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["RFC: ",(0,d.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/html/rfc5321#section-4.4",children:"https://datatracker.ietf.org/doc/html/rfc5321#section-4.4"})]}),"\n",(0,d.jsx)(n.li,{children:"Purpose: Specifies the return address for bounced messages (MAIL FROM in SMTP)."}),"\n",(0,d.jsx)(n.li,{children:"Set by: The final mail server upon delivery."}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"received-spf",children:(0,d.jsx)(n.code,{children:"Received-SPF"})}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["RFC: ",(0,d.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/html/rfc7208#section-9.1",children:"https://datatracker.ietf.org/doc/html/rfc7208#section-9.1"})]}),"\n",(0,d.jsx)(n.li,{children:"Purpose: Indicates the result of SPF (Sender Policy Framework) evaluation."}),"\n",(0,d.jsx)(n.li,{children:"Set by: The receiving server."}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"authentication-results",children:(0,d.jsx)(n.code,{children:"Authentication-Results"})}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["RFC: ",(0,d.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/html/rfc8601",children:"https://datatracker.ietf.org/doc/html/rfc8601"})]}),"\n",(0,d.jsx)(n.li,{children:"Purpose: Records the results of authentication checks like SPF, DKIM, and DMARC."}),"\n",(0,d.jsx)(n.li,{children:"Set by: Receiving server which does the authentication checks."}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"dkim-signature",children:(0,d.jsx)(n.code,{children:"DKIM-Signature"})}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["RFC: ",(0,d.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/html/rfc6376",children:"RFC 6376"})]}),"\n",(0,d.jsx)(n.li,{children:"Purpose: Contains the cryptographic signature and parameters for DKIM verification."}),"\n",(0,d.jsx)(n.li,{children:"Set by: Signing domain\u2019s outgoing SMTP server."}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"arc-seal-1",children:(0,d.jsx)(n.code,{children:"ARC-Seal"})}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["RFC: ",(0,d.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/html/rfc8617#section-4.1.3",children:"RFC 8617"})]}),"\n",(0,d.jsx)(n.li,{children:"Purpose: Protects the ARC chain\u2019s integrity and validity status."}),"\n",(0,d.jsx)(n.li,{children:"Set by: Intermediary forwarding server participating in ARC."}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"arc-message-signature-1",children:(0,d.jsx)(n.code,{children:"ARC-Message-Signature"})}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["RFC: ",(0,d.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/html/rfc8617#section-4.1.2",children:"RFC 8617"})]}),"\n",(0,d.jsx)(n.li,{children:"Purpose: Signs the original message content and headers at the ARC step."}),"\n",(0,d.jsx)(n.li,{children:"Set by: ARC-aware forwarder."}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"arc-authentication-results-1",children:(0,d.jsx)(n.code,{children:"ARC-Authentication-Results"})}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["RFC: ",(0,d.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/html/rfc8617#section-4.1.1",children:"RFC 8617"})]}),"\n",(0,d.jsx)(n.li,{children:"Purpose: Captures the authentication results (SPF, DKIM, DMARC) of the original message at the forwarding server."}),"\n",(0,d.jsx)(n.li,{children:"Set by: Forwarding server participating in ARC."}),"\n"]}),"\n",(0,d.jsx)(n.h2,{id:"envelope",children:"Envelope"}),"\n",(0,d.jsx)(n.p,{children:"The IMAP Envelope is extracted from the SMTP transaction metadata when the email is received by the server."}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Field"}),(0,d.jsx)(n.th,{children:"Source"}),(0,d.jsx)(n.th,{children:"Example"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"ENVELOPE.From"})}),(0,d.jsxs)(n.td,{children:["From the SMTP ",(0,d.jsx)(n.code,{children:"MAIL FROM"})]}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"MAIL FROM:<sender@example.com>"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"ENVELOPE.To"})}),(0,d.jsxs)(n.td,{children:["From the SMTP ",(0,d.jsx)(n.code,{children:"RCPT TO"})]}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"RCPT TO:<recipient@example.com>"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"ENVELOPE.Subject"})}),(0,d.jsx)(n.td,{children:"From the message headers"}),(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"Subject:"})," header"]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"ENVELOPE.Sender"})}),(0,d.jsx)(n.td,{children:"From headers, fallback logic"}),(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"Sender:"})," or ",(0,d.jsx)(n.code,{children:"From:"})," header"]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"ENVELOPE.Date"})}),(0,d.jsxs)(n.td,{children:["From ",(0,d.jsx)(n.code,{children:"Date:"})," header"]}),(0,d.jsx)(n.td,{})]})]})]}),"\n",(0,d.jsx)(n.h2,{id:"sending-an-email",children:"Sending an Email"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"MTA"}),": Mail Transfer Agent, responsible for sending, receiving, and routing email messages between email servers using the SMTP (Simple Mail Transfer Protocol)."]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"MDA"}),": Mail Delivery Agent, responsible delivery of e-mail messages to a local recipient's mailbox"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"MUA"}),": Mail User Agent, the email client."]}),"\n"]}),"\n",(0,d.jsx)(n.mermaid,{value:"sequenceDiagram\n    participant UserA as User A (Sender)\n    participant MUA1 as MUA (A's Client)\n    participant MTA1 as Sending MTA\n    participant MTA2 as Receiving MTA\n    participant MDA as MDA\n    participant MUA2 as MUA (B's Client)\n    participant UserB as User B (Receiver)\n\n    UserA->>MUA1: Compose & Send <br>Email\n    MUA1->>MTA1: Send email <br>via SMTP\n    MTA1->>MTA2: Deliver email via SMTP <br>(MX lookup)\n    MTA2->>MDA: Pass email <br>to mailbox\n    MUA2->>MDA: Retrieve email <br>via IMAP/POP3\n    MDA->>MUA2: Deliver email\n    MUA2->>UserB: Display message"}),"\n",(0,d.jsx)(n.h2,{id:"automatic-forwarding-with-arc-support",children:"Automatic Forwarding with ARC support"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"forwards an email without changing its original headers, through a succession of mail servers, where each time the email is processed, an ARC set is added."}),"\n",(0,d.jsx)(n.li,{children:'not to be mistaken by the manual "forward" action that a normal user can use. Unlike the manual "forward", the automatic forwarding does not change the email\'s body, subject and headers.'}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"unchanged-headers",children:"Unchanged Headers"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:"From, To, Subject,\nMessage-Id, Date,\nUser-Agent, Mime-Version,\nContent-Type, Content-Transfer-Encoding,\nDKIM-Signature (original)\n"})}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["same body (and ",(0,d.jsx)(n.code,{children:"bh"})," body hash)"]}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"added-headers",children:"Added Headers"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"for each MTA hop where a message is received from another MTA:"}),"\n"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:"Received\nReceived-SPF\nReceived\nReturn-Path\nARC-Authentication-Results: i=x;\nARC-Message-Signature: i=x;\nARC-Seal: i=x;\nDelivered-To\n"})}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"MTA's receiving an email from a MUA, to be forwarded, may also add ARC headers!"}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"example-gmail-automatic-server-side-forwarding-with-arc-support",children:"Example: Gmail automatic (server-side) forwarding with ARC support"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsxs)(n.th,{children:["ARC Set ",(0,d.jsx)(n.code,{children:"i="})]}),(0,d.jsx)(n.th,{children:"Who Added It"}),(0,d.jsx)(n.th,{children:"Why It Was Added"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"1"})}),(0,d.jsx)(n.td,{children:(0,d.jsxs)(n.strong,{children:["Receiver MTA receiving from ",(0,d.jsx)(n.code,{children:"mail.provable.dev"})]})}),(0,d.jsx)(n.td,{children:"Receiver MTA adds ARC headers (starts the chain)"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"2"})}),(0,d.jsx)(n.td,{children:(0,d.jsxs)(n.strong,{children:["Sending MTA receiving from ",(0,d.jsx)(n.code,{children:"thelaurel.bot@gmail.com"})," MUA"]})}),(0,d.jsx)(n.td,{children:"MTA prepares for forwarding and adds another ARC set"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"3"})}),(0,d.jsx)(n.td,{children:(0,d.jsxs)(n.strong,{children:["Receiver MTA for ",(0,d.jsx)(n.code,{children:"seth.one.info@gmail.com"})]})}),(0,d.jsx)(n.td,{children:"Receiver MTA adds ARC headers"})]})]})]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:'Delivered-To: seth.one.info@gmail.com\nReceived: by 2002:a05:7022:68aa:b0:9b:65ec:421a with SMTP id cm42csp2343619dlb;\n        Tue, 10 Jun 2025 14:12:05 -0700 (PDT)\nX-Forwarded-Encrypted: i=4; AJvYcCVxh8PFglGFqOAP+AsLsh/f3ftGU5tylg0uHg8ZsqaSMFRQYWNrLE3Tp5rvRf5ucX1jjvHcw8HSS89TgMVP@gmail.com\nX-Received: by 2002:a17:90b:5404:b0:311:a623:676c with SMTP id 98e67ed59e1d1-313af243c3bmr1398936a91.27.1749589924825;\n        Tue, 10 Jun 2025 14:12:04 -0700 (PDT)\nARC-Seal: i=3; a=rsa-sha256; t=1749589924; cv=pass;\n        d=google.com; s=arc-20240605;\n        b=k/DDEvhaKSwq1fjWM0FrkW5lbFEVRHln8sdi0ExNdxC5DX2e6Wcc+yDxxesyjpccS/\n         H8f5Ii2NnZShlTB37lgzP0s8knWd0sLnqorv/EM9DaCU/jRPwcPN51k4TOdMZqxzCzUy\n         MHPNZzTN1o4XomdeC2EP2gw90XdaYhzTlmwR6F4uRdU42uPTPfAxHQp7muQSqez8ptF+\n         GC641X6SE9SrCMNdakyj14W85fhc6rRvTzf8itaD1Rl3W3BoYjulSGVoRSYWS16He3uT\n         l6YR7/0sc0tAKKhLYdkwesc81qo65crK6Qc/4F3Xq1iS88+kDc9kqizrg0lT++PNfFgO\n         BC0w==\nARC-Message-Signature: i=3; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20240605;\n        h=content-transfer-encoding:mime-version:user-agent:date:message-id\n         :subject:to:from:dkim-signature:dkim-signature:delivered-to;\n        bh=4fWAjR8dybJoJ7oc+ua358Qnylv7LASFrox6UiJwQ8g=;\n        fh=Ml91QZNjOUBF4lPxdodEISvnG8cKMzALenqeNxoWqdI=;\n        b=VEGNq275dIibd6+54GYZnP2dIHqFiGkAwALj/FA4hw7weJGTiFvfcb/O7p20PPWbUY\n         isM3m4twYpknpID3hRN/euJJNWqj4VgclnJST3nQ+F0WgfwBCOl/wuVJbu9pO9vgJAY7\n         WglNuiona7FL0Rlwp+KGHllLbR5CA0pak3s9E+OI3fhZya9/v5Gldis8vzsyfOiCnGta\n         5IYVB42Mgdi+tS2SaUaHqPUL+g9eo2hnca56CTkEieuOZcLFDcCOHQTZol4n8ti5aiiI\n         UB2EKnu+PC1JX7Tm2MYYBbIRZhuB9OF2TQat13rr8Hph3I1/cupScIWFRr/8Hkh4PP0q\n         9kUw==;\n        dara=google.com\nARC-Authentication-Results: i=3; mx.google.com;\n       dkim=neutral (no key) header.i=@mail.provable.dev header.s=2024a;\n       dkim=pass header.i=@mail.provable.dev header.s=2024b header.b=K043WB+2;\n       arc=pass (i=2 spf=pass spfdomain=mail.provable.dev dkim=pass dkdomain=mail.provable.dev dmarc=pass fromdomain=mail.provable.dev);\n       spf=pass (google.com: domain of thelaurel.bot+caf_=seth.one.info=gmail.com@gmail.com designates 209.85.220.41 as permitted sender) smtp.mailfrom="thelaurel.bot+caf_=seth.one.info=gmail.com@gmail.com";\n       dmarc=pass (p=REJECT sp=REJECT dis=NONE) header.from=mail.provable.dev;\n       dara=pass header.i=@gmail.com\nReturn-Path: <thelaurel.bot+caf_=seth.one.info=gmail.com@gmail.com>\nReceived: from mail-sor-f41.google.com (mail-sor-f41.google.com. [209.85.220.41])\n        by mx.google.com with SMTPS id 98e67ed59e1d1-3134b0d75c5sor6293160a91.5.2025.06.10.14.12.04\n        for <seth.one.info@gmail.com>\n        (Google Transport Security);\n        Tue, 10 Jun 2025 14:12:04 -0700 (PDT)\nReceived-SPF: pass (google.com: domain of thelaurel.bot+caf_=seth.one.info=gmail.com@gmail.com designates 209.85.220.41 as permitted sender) client-ip=209.85.220.41;\nAuthentication-Results: mx.google.com;\n       dkim=neutral (no key) header.i=@mail.provable.dev header.s=2024a;\n       dkim=pass header.i=@mail.provable.dev header.s=2024b header.b=K043WB+2;\n       arc=pass (i=2 spf=pass spfdomain=mail.provable.dev dkim=pass dkdomain=mail.provable.dev dmarc=pass fromdomain=mail.provable.dev);\n       spf=pass (google.com: domain of thelaurel.bot+caf_=seth.one.info=gmail.com@gmail.com designates 209.85.220.41 as permitted sender) smtp.mailfrom="thelaurel.bot+caf_=seth.one.info=gmail.com@gmail.com";\n       dmarc=pass (p=REJECT sp=REJECT dis=NONE) header.from=mail.provable.dev;\n       dara=pass header.i=@gmail.com\nARC-Seal: i=2; a=rsa-sha256; t=1749589924; cv=pass;\n        d=google.com; s=arc-20240605;\n        b=PouceSL2DqOihx6kLx+r9iuch/opZ8mVFCT+4tXOP74GLkG2RcfTWKb04BU93eggDN\n         loMcaG+T9vCo7g1PnSUr4EuzLRW3BwGek4t3LHBKp4u7U3M0aY2X1bGmnz3EqKe/V9gq\n         7zv+ExdakSyHwszZU2fOwBEPW1KKOvdILiMkhNLepgX0lzioJ9zJnBDvKhDU3ZxPcbWB\n         vOmNNTX8VH9seQaqgVKh5sqtpyvPYT4mlVAYURZTUNYOZe7RD7yUygIxgyjyvIbDNRN3\n         kin4YzCEHL2vsnYFNr1ZnuKyOMF0RBm9xNpiAIgQt33ClS4iLCzTSiQKIOCToWrWJaHQ\n         bYdg==\nARC-Message-Signature: i=2; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20240605;\n        h=content-transfer-encoding:mime-version:user-agent:date:message-id\n         :subject:to:from:dkim-signature:dkim-signature:delivered-to;\n        bh=4fWAjR8dybJoJ7oc+ua358Qnylv7LASFrox6UiJwQ8g=;\n        fh=Ml91QZNjOUBF4lPxdodEISvnG8cKMzALenqeNxoWqdI=;\n        b=Hx3YZqrTC2sXvj25ntj9xc3nBMaYfOwJZQV/SG86UJirOs+P3uEcb1cqtFrSJM1BEQ\n         YFTzYSdQDuGkNzVSKGqP0Vd/SEJZH7WyLRv7KL4ZXaemGu072mnfr8KScHYqoo0Jh/68\n         O24YBOyLqnhi6LmCrbCTNasROMQjmkYeH8CFxw8e3beTzurVWtzoRbtw0SSdaLhlCX8M\n         hPR7bKy1xwUqpIUdzoXGhjMyvvdJjGWVoGX8R5ouHrD+/sGL/yUsoTE4nEUW8Os2L4cB\n         vCq7VGvwOTEYc8h++m50bsix5PIWne06Lu51QVfIIoocy1bIesjg5OEgO3LdEVbXBZyG\n         /28g==;\n        dara=google.com\nARC-Authentication-Results: i=2; mx.google.com;\n       dkim=neutral (no key) header.i=@mail.provable.dev header.s=2024a;\n       dkim=pass header.i=@mail.provable.dev header.s=2024b header.b=K043WB+2;\n       spf=pass (google.com: domain of test@mail.provable.dev designates 85.215.130.119 as permitted sender) smtp.mailfrom=test@mail.provable.dev;\n       dmarc=pass (p=REJECT sp=REJECT dis=NONE) header.from=mail.provable.dev\nX-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;\n        d=1e100.net; s=20230601; t=1749589924; x=1750194724;\n        h=content-transfer-encoding:mime-version:user-agent:date:message-id\n         :subject:to:from:dkim-signature:dkim-signature:delivered-to\n         :x-forwarded-for:x-forwarded-to:x-gm-message-state:from:to:cc\n         :subject:date:message-id:reply-to;\n        bh=4fWAjR8dybJoJ7oc+ua358Qnylv7LASFrox6UiJwQ8g=;\n        b=A5W976h4O/CG/P73lVKQhrPQ9m4Ck8gtOXsdq5r8rYC96rVKE2+l9fxiDW9EyP8Fw2\n         cC/beXjlqXq2x0+7Slgz69xswg7YgQnbOqKNeuw2lnVySpVzm37ofzJxYJc0DlOd8GZf\n         2BclsyFeawJdBw9ShN8hML5lFuSnB/c5BKMUqnZPL2dv2Nn+mecGSGupNKUozgEQoGUB\n         33FZSuu/OJXq80W4g1Zw6f9OI4N5GryuDvkRcMEosr8FXs1oK49LyEL+BLBOkob1ZSq1\n         B9gNHndx1UWdQnAeRugVnVMLbc55g5ljjxPFN/apaXpJRf4d9V44xw0EfXcmxxY95hgN\n         v+bQ==\nX-Forwarded-Encrypted: i=2; AJvYcCVzwbjjEAn5P65ODzz5UJic0iiOWnQHTvzj+23T52cihhu/6J1FehAdcICTsY1M7IXbPZnrUSFw65UJyBVB@gmail.com\nX-Gm-Message-State: AOJu0YwiMmE5+S3vAQj289iAzNuPgjbJqMI42CnVzMr66JItgosD727m +unReCJQNgqhYxwHtnnFQiQhBmE3/0ADm9XcB5G4XovduYB6KUD2S+/rrHuvOs5YuZcYZj++huL Hw2wxPRD5V8wimIXezGumI7/zoVPN+ZoTHKUfpnRc+QUrVT3ibavXbx1LCU63Pg==\nX-Received: by 2002:a17:90b:540c:b0:311:9c9a:58c5 with SMTP id 98e67ed59e1d1-313af142493mr1762856a91.12.1749589924287;\n        Tue, 10 Jun 2025 14:12:04 -0700 (PDT)\nX-Forwarded-To: seth.one.info@gmail.com\nX-Forwarded-For: thelaurel.bot@gmail.com seth.one.info@gmail.com\nDelivered-To: thelaurel.bot@gmail.com\nReceived: by 2002:a05:7300:6d24:b0:175:1578:60a4 with SMTP id n36csp3474650dyo;\n        Tue, 10 Jun 2025 14:12:02 -0700 (PDT)\nX-Google-Smtp-Source: AGHT+IGwIyJJdBos2ffdx/X/IC6i7UKNrd9AfPlY7u8egXNfndrqa6B29sAySEG1UljObzr+iz+b\nX-Received: by 2002:a05:6000:2210:b0:3a4:f55a:4ae2 with SMTP id ffacd0b85a97d-3a558ae65d0mr363669f8f.50.1749589922667;\n        Tue, 10 Jun 2025 14:12:02 -0700 (PDT)\nARC-Seal: i=1; a=rsa-sha256; t=1749589922; cv=none;\n        d=google.com; s=arc-20240605;\n        b=dS95Wj+Z/5+cuo9YJOHYkKM75GTGamBg6uPljF+TKJ/ooHPDasKA+szz6fxcsac21v\n         9xyEArJm5fxl4xAs2xHoL30nxbhr8UTZWbIFjLwRWuQrallGyaVVgEl8/muaI3vnty1P\n         k79jIFaYkdGmHGymYm0LcszSAF0Hws0Y9ojWnP5ENICQOxYWf9M0YWVmpVfov6BuNt0D\n         F7q+RTz0CaOvXQqQCymsRZFrwln9zPLBFXoJ8MjH3M3wDJKcvX7ymKY9BgJ+odvwyeKv\n         FLqaK0vu6JGqerHBOtAjbq4qtvG34IdS2qRtVJ+qG+IxJdufEaQi+HLp6StWUvoSBPwi\n         /GCg==\nARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20240605;\n        h=content-transfer-encoding:mime-version:user-agent:date:message-id\n         :subject:to:from:dkim-signature:dkim-signature;\n        bh=4fWAjR8dybJoJ7oc+ua358Qnylv7LASFrox6UiJwQ8g=;\n        fh=kPQEZMPS3Hwz+5rPK66FFY2UWO38OU1FMnbjU+jALNQ=;\n        b=Sx7U7BxxT/dDSF7NXPF2gMMWxgEDzVc97UB5qx4C9MVL/nJB9NS9yE3y71QOR6ehvh\n         8hrToCspPAZk6G/HDDuhX9zs48FvpRgLf01dbtq656XG3SZFb0++0likj310jW/7kRIG\n         hWbWIJK95qwdMedBm4bkclpGCFauAgidblDf00nIdLd8yHTefYeuOFh3x9fYpUcD4sLh\n         tHCpcVXgsjToEHKy+hgMQUzMfZs8mNKyL59x4wesN56wOMTKFdd245oysRqHPzkgnQak\n         77rmJVxo6GYb37/zp6mXjoZQ+BQHOg8bB8MGpzyZhjuwqbRrj/+EnMg0b0F6z4bSIlok\n         SDyg==;\n        dara=google.com\nARC-Authentication-Results: i=1; mx.google.com;\n       dkim=neutral (no key) header.i=@mail.provable.dev header.s=2024a;\n       dkim=pass header.i=@mail.provable.dev header.s=2024b header.b=K043WB+2;\n       spf=pass (google.com: domain of test@mail.provable.dev designates 85.215.130.119 as permitted sender) smtp.mailfrom=test@mail.provable.dev;\n       dmarc=pass (p=REJECT sp=REJECT dis=NONE) header.from=mail.provable.dev\nReturn-Path: <test@mail.provable.dev>\nReceived: from mail.provable.dev (mail.provable.dev. [85.215.130.119])\n        by mx.google.com with ESMTPS id ffacd0b85a97d-3a53244fc3asi7920677f8f.247.2025.06.10.14.12.02\n        for <thelaurel.bot@gmail.com>\n        (version=TLS1_3 cipher=TLS_AES_128_GCM_SHA256 bits=128/128);\n        Tue, 10 Jun 2025 14:12:02 -0700 (PDT)\nReceived-SPF: pass (google.com: domain of test@mail.provable.dev designates 85.215.130.119 as permitted sender) client-ip=85.215.130.119;\nReceived: from mail.provable.dev by mail.provable.dev id n5-sNLLrTuZJYpcmGH8G1g for <thelaurel.bot@gmail.com>; 10 Jun 2025 21:12:02 +0000\nDKIM-Signature: v=1; d=mail.provable.dev; s=2024a; i=test@mail.provable.dev; a=ed25519-sha256; t=1749589922; x=1749849122; h=From:To:Cc:Bcc:Reply-To: References:In-Reply-To:Subject:Date:Message-Id:Content-Type:From:To:Subject: Date:Message-Id:Content-Type; bh=4fWAjR8dybJoJ7oc+ua358Qnylv7LASFrox6UiJwQ8g=; b=7J39El5KDL4NPguv2fK3m7xm/F evJN9QFqECm90XGwfWnlqBEEjHteY/P28AJ5xwfenf08TdtBLIMes6PMZTBA==\nDKIM-Signature: v=1; d=mail.provable.dev; s=2024b; i=test@mail.provable.dev; a=rsa-sha256; t=1749589922; x=1749849122; h=From:To:Cc:Bcc:Reply-To: References:In-Reply-To:Subject:Date:Message-Id:Content-Type:From:To:Subject: Date:Message-Id:Content-Type; bh=4fWAjR8dybJoJ7oc+ua358Qnylv7LASFrox6UiJwQ8g=; b=K043WB+2sby57d3sihT+xRSou8 H2+XTKqUxrfBRaOa6q48hcUs7DVg9n+0bA6T7cAQYlNsc1MNoViH5ebdjYKigJepnwrh4CCGweJUZ plhBWUF2McU4Kgz8XaLyCt5ipots2aOLRG7yT0FkudXYBY2bnG64fbyQABf6LClIF9Gwuq8gNF5Mj YF+oZZCZdnsQnf/AT+qDYCjOgTbjoPosZDOypsHSu42/m12UsYEqAZsBrsqaFV1rmFLlpdWzQ8y41 dySACyWpRiVayzU5vFvfBkd/juhG94xlER9cs8RLE/oeFXqtOqq21HDUfqLp3koxqOeHTgmctN/0r BI+nuopA==\nFrom: <test@mail.provable.dev>\nTo: <thelaurel.bot@gmail.com>\nSubject: Testing forwarding\nMessage-Id: <uaeCGNbn4n1NJX6igHstlA@mail.provable.dev>\nDate: 10 Jun 2025 21:12:02 +0000\nUser-Agent: moxwebmail/v0.0.10\nMIME-Version: 1.0\nContent-Type: text/plain; charset=us-ascii\nContent-Transfer-Encoding: 7bit\n\nTesting forwarding body\n\n'})}),"\n",(0,d.jsx)(n.h2,{id:"manual-forwarding",children:"Manual Forwarding"}),"\n",(0,d.jsx)(n.p,{children:"If a user wants to manually forward an email to another user, most of the original email is changed by the forwarding MUA & MTA."}),"\n",(0,d.jsx)(n.h3,{id:"changed-headers",children:"Changed Headers"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:"From\nTo\nDate\nMessage-ID\nSubject\nContent-Type\nDKIM-Signature\nReferences\nIn-Reply-To\n"})}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["changed email body (and therefore ",(0,d.jsx)(n.code,{children:"bh"})," field)"]}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"added-headers-by-receiving-mta",children:"Added Headers by Receiving MTA"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:"Delivered-To\nReceived\nARC-Seal: i=1;\nARC-Message-Signature: i=1;\nARC-Authentication-Results: i=1;\nReturn-Path\nReceived-SPF\nAuthentication-Results\n"})}),"\n",(0,d.jsx)(n.h3,{id:"original-email-information-in-the-forwarded-email",children:"Original Email Information in the Forwarded Email"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"the email body can contain a copy of the original email, with no way to prove that the content is the same as the original email"}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"References"})," and ",(0,d.jsx)(n.code,{children:"In-Reply-To"})," reference the original ",(0,d.jsx)(n.code,{children:"Message-ID"})]}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"example-gmail-manual-forward",children:"Example: Gmail manual forward"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["instead of automatically forwarding the email from ",(0,d.jsx)(n.code,{children:"thelaurel.bot"})," to ",(0,d.jsx)(n.code,{children:"seth.info"}),", now we are manually forwarding it."]}),"\n"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:'Delivered-To: seth.one.info@gmail.com\nReceived: by 2002:a05:7022:68aa:b0:9b:65ec:421a with SMTP id cm42csp3414764dlb;\n        Thu, 12 Jun 2025 05:50:14 -0700 (PDT)\nX-Received: by 2002:a17:902:e74b:b0:234:8ef1:aa7b with SMTP id d9443c01a7336-23641abca6bmr103950355ad.20.1749732614667;\n        Thu, 12 Jun 2025 05:50:14 -0700 (PDT)\nARC-Seal: i=1; a=rsa-sha256; t=1749732614; cv=none;\n        d=google.com; s=arc-20240605;\n        b=aYhU5pBdpFG0f0vGAA6NtU6KxRtMfsku2OL259C42A91ei+dhk4yjiYm+UmD3rj/Tf\n         UfH2gptcsIil2fEdSm0Pfq+gEFBpz7/VoFkj874v2thK3lUl13SqWN8U14w/cawAdPfX\n         z49S7NyrqJN428aRaTe7Ld+RdBha0ZI0Qh3LwliO3f6J0C8JeshGjdqMGPxZsVxy/bvh\n         ofCUHiXKsf5OfKSMcAY5v7DNSmxi14d9TIpb4Tra1XUw17lB2FkIu6cLd6aYAZxQEDsj\n         b9jemiaH+RbJt+d8XROIT7z+6OzF/k9wHypGcTEoZzVz/ZqfEynhDeAlAV0DHAR7J+te\n         oV1A==\nARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20240605;\n        h=to:subject:message-id:date:from:in-reply-to:references:mime-version\n         :dkim-signature;\n        bh=zNnb+VkDrT/I3UU7kd/InOkFcj73kOvO3T1aNoOZoYk=;\n        fh=5EpvDt+ShiZGXW0fMSFmw2r+hZoF+7FPLlq4kibCHO8=;\n        b=CcDxEBsvHWxkAGe2yXLV3lpC/60xFO8Kw7GLlkOM3DfMUpzD1G+mqWP6IU7+HCRVIu\n         D/+T5R66MMPu46ZAWGFyJzMHqqMlDNpu23eBSOZepLTvewhidfBhYOsctwpixOx4yfG2\n         N0p/T15Gj5cC60tSqhmAcxZNQuc+Z2t8onAGSDU5AiwkR0nxKYKqospV7kvdaHMAmcNh\n         ZnjZLmXf1ilWIJqOgK34wx67qZwZz9k0QRiGIobjaXFeIfYms7OOeU9jRmnEK99L0d6f\n         sLm+ZHik5zvKCH7oEWhj0Vp9FvXFXnVJI21ksj32SZr2QjiOO+nf8dXVRyp+4+go8xEq\n         JDeA==;\n        dara=google.com\nARC-Authentication-Results: i=1; mx.google.com;\n       dkim=pass header.i=@gmail.com header.s=20230601 header.b="O2Wz/L8j";\n       spf=pass (google.com: domain of thelaurel.bot@gmail.com designates 209.85.220.41 as permitted sender) smtp.mailfrom=thelaurel.bot@gmail.com;\n       dmarc=pass (p=NONE sp=QUARANTINE dis=NONE) header.from=gmail.com;\n       dara=pass header.i=@gmail.com\nReturn-Path: <thelaurel.bot@gmail.com>\nReceived: from mail-sor-f41.google.com (mail-sor-f41.google.com. [209.85.220.41])\n        by mx.google.com with SMTPS id d9443c01a7336-2364e6210e5sor9621785ad.7.2025.06.12.05.50.14\n        for <seth.one.info@gmail.com>\n        (Google Transport Security);\n        Thu, 12 Jun 2025 05:50:14 -0700 (PDT)\nReceived-SPF: pass (google.com: domain of thelaurel.bot@gmail.com designates 209.85.220.41 as permitted sender) client-ip=209.85.220.41;\nAuthentication-Results: mx.google.com;\n       dkim=pass header.i=@gmail.com header.s=20230601 header.b="O2Wz/L8j";\n       spf=pass (google.com: domain of thelaurel.bot@gmail.com designates 209.85.220.41 as permitted sender) smtp.mailfrom=thelaurel.bot@gmail.com;\n       dmarc=pass (p=NONE sp=QUARANTINE dis=NONE) header.from=gmail.com;\n       dara=pass header.i=@gmail.com\nDKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;\n        d=gmail.com; s=20230601; t=1749732614; x=1750337414; dara=google.com;\n        h=to:subject:message-id:date:from:in-reply-to:references:mime-version\n         :from:to:cc:subject:date:message-id:reply-to;\n        bh=zNnb+VkDrT/I3UU7kd/InOkFcj73kOvO3T1aNoOZoYk=;\n        b=O2Wz/L8ji9CW7Xi56aiHmISB7v7KSkxzwmPulYvjzIblcABE6gWtMGUMdxQZV2R85T\n         Lk0kpgcra4Toqc7+oiRHaZgdMgcDG2jmbCRYmi9PsCJznqgZ0O0dj7aExCy+53kViMpn\n         msAiRElv2JaHrnx410S5kYQeouu+keYNrbpvLQJWTi3iM93Xhsjc3srOx/+4yhFd9oNs\n         a+nm++bY6FB62joVIWbjjvxoNYHmiemuCXQ2FTRkO5GCvGx99NZwNNR+oAnCYfKAnb4B\n         69zwFhE8U0+w2pFMX2i7Mr32qlRLZrYOQ526SfFy9fiISKwAZ75VMflLWkVR3L//3Pge\n         PZ/w==\nX-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;\n        d=1e100.net; s=20230601; t=1749732614; x=1750337414;\n        h=to:subject:message-id:date:from:in-reply-to:references:mime-version\n         :x-gm-message-state:from:to:cc:subject:date:message-id:reply-to;\n        bh=zNnb+VkDrT/I3UU7kd/InOkFcj73kOvO3T1aNoOZoYk=;\n        b=TFi2UBqdfGNPUu10F3XefehWqhZ88vZGMFE0BL6aLU1WpvuN85YJe7GAJXjm8+Lz/x\n         6ltdE8ym2KX+KH8ekcQX+FWMJoAsuQCEGMt0jpBH4StdedpAgu8XfASOBaN3OwBQnERN\n         hLmuWeS/O9AJfL2uXVUxl90z08wV/jPv0ft2cuejm4FKzgZ7hQcwWFwzjfwFMsHQnEOX\n         mxy0f8OBi1juDWjp8DAzYgj496uYIe7mj7K7PkDFFc+bPrZD0324brbghkI2R80Reo9T\n         5Sf/QWX1I4HojrxoeH0yQZAqAXTnrxw0Tbj6mvyRMl5IUg1dgJ+C0Ja7KjIG3BSknuIP\n         WvHQ==\nX-Gm-Message-State: AOJu0YyTYc6vJwrOodmwCvIfqCle2QR3ZkVW50nfUBN4dkfon8zfxKNe iO9w+yJZ8zgI+VASC2RG7ncHo4+g2ooiy2tZdF+MDDapBIQvKcx94x+9jOdFNV0RyTYgqWIGjNE p3HAkjZqS+0m1JRPI4QSafRybgcqSZnw=\nX-Gm-Gg: ASbGncvGTP9jrvusurKQI+ss2xwMg4Rt756nzQ4gq49XmvJNgN9wqM7ot3tubKKABwX lEePhgwlF5/wFMpVOUcF1DN2CJEUk8WnCL90aMinnlkLSi9+FuoYRqbzlDzsraQ+PBtS3W1/RSp Cg\nX-Google-Smtp-Source: AGHT+IEWOjQuMbHFCoiZ+Dy96L1cRht7F1FnbHPaINsVArFFOTvi56tBawfkKp7roH4U92M5uTo6HDx65ZFW5ac7YHs=\nX-Received: by 2002:a17:90b:438f:b0:312:e76f:5213 with SMTP id 98e67ed59e1d1-313af2034damr7893079a91.28.1749732611770; Thu, 12 Jun 2025 05:50:11 -0700 (PDT)\nMIME-Version: 1.0\nReferences: <uaeCGNbn4n1NJX6igHstlA@mail.provable.dev>\nIn-Reply-To: <uaeCGNbn4n1NJX6igHstlA@mail.provable.dev>\nFrom: The Laurel Bot <thelaurel.bot@gmail.com>\nDate: Thu, 12 Jun 2025 14:50:00 +0200\nX-Gm-Features: AX0GCFsbpVmqrPm0J16GOtkAILje3vE9SR-iLhuhD2bFKlcqbDQ_IG5MwPYPTKU\nMessage-ID: <CANGBCcU3-rqvcwR_5EHFh3ZL3k46UgAFoUQ6v6BC5U1Q4DMi=w@mail.gmail.com>\nSubject: Fwd: Testing forwarding\nTo: "seth.one.info@gmail.com" <seth.one.info@gmail.com>\nContent-Type: multipart/alternative; boundary="000000000000c6cc6806375f5e76"\n\n--000000000000c6cc6806375f5e76\nContent-Type: text/plain; charset="UTF-8"\n\n---------- Forwarded message ---------\nFrom: <test@mail.provable.dev>\nDate: Tue, 10 Jun 2025 at 23:12\nSubject: Testing forwarding\nTo: <thelaurel.bot@gmail.com>\n\n\nTesting forwarding body\n\n--000000000000c6cc6806375f5e76\nContent-Type: text/html; charset="UTF-8"\nContent-Transfer-Encoding: quoted-printable\n\n<div dir=3D"ltr"><br><br><div class=3D"gmail_quote gmail_quote_container"><=\ndiv dir=3D"ltr" class=3D"gmail_attr">---------- Forwarded message ---------=\n<br>From: <span dir=3D"auto">&lt;<a href=3D"mailto:test@mail.provable.dev">=\ntest@mail.provable.dev</a>&gt;</span><br>Date: Tue, 10 Jun 2025 at 23:12<br=\n>Subject: Testing forwarding<br>To:  &lt;<a href=3D"mailto:thelaurel.bot@gm=\nail.com">thelaurel.bot@gmail.com</a>&gt;<br></div><br><br>Testing forwardin=\ng body<br>\n</div></div>\n\n--000000000000c6cc6806375f5e76--\n'})})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,d.jsx)(n,{...e,children:(0,d.jsx)(o,{...e})}):o(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>a,x:()=>l});var r=i(6540);const d={},s=r.createContext(d);function a(e){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:a(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);