"use strict";(self.webpackChunkwasmx_docs=self.webpackChunkwasmx_docs||[]).push([[4636],{7465:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>t,contentTitle:()=>l,default:()=>h,frontMatter:()=>d,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"architecture/provable_email_forwarding","title":"Provable Email Forwarding","description":"Provable Manual Email Forwarding (user-triggered)","source":"@site/docs/architecture/provable_email_forwarding.md","sourceDirName":"architecture","slug":"/architecture/provable_email_forwarding","permalink":"/docs/architecture/provable_email_forwarding","draft":false,"unlisted":false,"editUrl":"https://github.com/loredanacirstea/wasmx-docs/tree/main/docs/architecture/provable_email_forwarding.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"title":"Provable Email Forwarding","description":"Provable Manual Email Forwarding (user-triggered)","image":"/img/email1.png","keywords":["SPF","DKIM","DMARC","ARC","email","Sender Policy Framework","DomainKeys Identified Mail","Domain-based Message Authentication","Authenticated Received Chain","cryptography","forwarding","email forwarding"]},"sidebar":"tutorialSidebar","previous":{"title":"wasmx","permalink":"/docs/apis/wasmx"},"next":{"title":"Email Verification Protocols","permalink":"/docs/architecture/email"}}');var a=i(4848),s=i(8453);const d={sidebar_position:1,title:"Provable Email Forwarding",description:"Provable Manual Email Forwarding (user-triggered)",image:"/img/email1.png",keywords:["SPF","DKIM","DMARC","ARC","email","Sender Policy Framework","DomainKeys Identified Mail","Domain-based Message Authentication","Authenticated Received Chain","cryptography","forwarding","email forwarding"]},l="Provable Email Forwarding",t={},o=[{value:"Prelude",id:"prelude",level:2},{value:"Manual Forwarding Now",id:"manual-forwarding-now",level:2},{value:"1. Provable Manual Forwarding with ARC",id:"1-provable-manual-forwarding-with-arc",level:2},{value:"2. Provable Manual Forwarding with Custom Headers &amp; Blockchain Integration",id:"2-provable-manual-forwarding-with-custom-headers--blockchain-integration",level:2},{value:"Unchanged",id:"unchanged",level:3},{value:"Changed Headers by Forwarding MTA",id:"changed-headers-by-forwarding-mta",level:3},{value:"Added Headers by Forwarding MTA",id:"added-headers-by-forwarding-mta",level:3},{value:"<code>Provable-DNS-Registry</code>",id:"provable-dns-registry",level:3},{value:"<code>Provable-Email-Registry</code>",id:"provable-email-registry",level:3},{value:"<code>Provable-Forward-Origin-DKIM-Context</code>",id:"provable-forward-origin-dkim-context",level:3},{value:"<code>Provable-Forward-Signature</code>",id:"provable-forward-signature",level:3},{value:"Notes:",id:"notes",level:3},{value:"Extensions",id:"extensions",level:3}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"provable-email-forwarding",children:"Provable Email Forwarding"})}),"\n",(0,a.jsx)(n.p,{children:"wasmX offers email verification standards for truly provable email."}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.a,{href:"/docs/architecture/email",children:"Current standards"})," are not enough."]}),"\n",(0,a.jsx)(n.h2,{id:"prelude",children:"Prelude"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["header registry:\n",(0,a.jsx)(n.a,{href:"https://www.iana.org/assignments/message-headers/message-headers.xhtml",children:"https://www.iana.org/assignments/message-headers/message-headers.xhtml"})]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["deprecating ",(0,a.jsx)(n.code,{children:"X-"})," prefix for custom headers ",(0,a.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/html/rfc6648",children:"https://datatracker.ietf.org/doc/html/rfc6648"}),". Just use a unique and relevant prefix."]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"manual-forwarding-now",children:"Manual Forwarding Now"}),"\n",(0,a.jsxs)(n.p,{children:["Current standards for ",(0,a.jsx)(n.a,{href:"./email#manual-forwarding",children:"manual email forwarding"})," do not allow users to verify the authenticity of a forwarded email. The email body is often changed by the email client itself."]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Why?"}),": Because society needs provability in order to have peace. And if communications are provable digitally, it reduces the need for abusive institutions to seize devices that may be an intrinsic part of your identity and everyday life."]}),"\n",(0,a.jsx)(n.h2,{id:"1-provable-manual-forwarding-with-arc",children:"1. Provable Manual Forwarding with ARC"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"similar to automatic forwarding"}),"\n",(0,a.jsx)(n.li,{children:"do not change the original email"}),"\n",(0,a.jsx)(n.li,{children:"forwarding MTA's and receiving MTA's should add ARC headers"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"PROs:"})}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"can verify original email authenticity"}),"\n",(0,a.jsxs)(n.li,{children:["provable intermediary chain - ",(0,a.jsx)(n.code,{children:"ARC-Seal"})," signs ",(0,a.jsx)(n.code,{children:"ARC-Authentication-Results"}),", which must contain ",(0,a.jsx)(n.code,{children:"smtp.mailfrom"})," (sending email account)"]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"CONs:"})}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"requires MTA-level control"}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"DKIM-Signature"})," expires and standard DKIM verification fails"]}),"\n",(0,a.jsx)(n.li,{children:"DNS key rotation will make it impossible to verify DKIM and ARC signatures and forwarding will fail"}),"\n",(0,a.jsx)(n.li,{children:"intermediary privacy concerns: ARC exposes the authentication results and MTA domains of all intermediaries \u2014 may reveal infrastructure, forwarding flows, or internal systems"}),"\n",(0,a.jsx)(n.li,{children:"end-user email clients (MUAs) rarely parse or display ARC results, so users won\u2019t benefit without explicit client support or plugins."}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"2-provable-manual-forwarding-with-custom-headers--blockchain-integration",children:"2. Provable Manual Forwarding with Custom Headers & Blockchain Integration"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"DNS key rotation is solved by keeping historical DNS public keys on a verifiable decentralized system"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"PROs:"})}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"can verify original email authenticity"}),"\n",(0,a.jsx)(n.li,{children:"provable intermediary chain"}),"\n",(0,a.jsx)(n.li,{children:"maintain compatibility with current email verification checks, so emails are not marked as invalid or spam"}),"\n",(0,a.jsx)(n.li,{children:"can work even without MTA support (custom headers are produced by MUAs, with user-controlled keys and blockchain-published public keys) - decentralization of protocol, users can choose individually"}),"\n",(0,a.jsxs)(n.li,{children:["historical email verification for ",(0,a.jsx)(n.code,{children:"DKIM"}),", ",(0,a.jsx)(n.code,{children:"ARC"})," and ",(0,a.jsx)(n.code,{children:"PROVABLE"})," headers"]}),"\n",(0,a.jsxs)(n.li,{children:["maintains the integrity of context/thread by including the ",(0,a.jsx)(n.code,{children:"References"})," of previous emails."]}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"CONs:"}),"\nTBD"]}),"\n",(0,a.jsx)(n.h3,{id:"unchanged",children:"Unchanged"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["email body remains the same -> ",(0,a.jsx)(n.code,{children:"bh"})," remains the same"]}),"\n",(0,a.jsx)(n.li,{children:"headers"}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"MIME-Version\nContent-Type\nContent-Transfer-Encoding\nDKIM-Signature\nARC headers\n"})}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["original ",(0,a.jsx)(n.code,{children:"DKIM-Signature"})," is kept, even if it may be expired"]}),"\n",(0,a.jsx)(n.li,{children:"original ARC headers, if the email was automatically forwarded"}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"changed-headers-by-forwarding-mta",children:"Changed Headers by Forwarding MTA"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"From\nTo\nDate\nMessage-ID\nSubject\nReferences\nIn-Reply-To\n"})}),"\n",(0,a.jsx)(n.h3,{id:"added-headers-by-forwarding-mta",children:"Added Headers by Forwarding MTA"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"DKIM-Signature\nProvable-DNS-Registry\nProvable-Email-Registry\nProvable-Forward-Origin-DKIM-Context\nProvable-Forward-Chain-Signature\n"})}),"\n",(0,a.jsx)(n.h3,{id:"provable-dns-registry",children:(0,a.jsx)(n.code,{children:"Provable-DNS-Registry"})}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"a decentralized DNS registry with current and historical DNS records, for verifying SPF, DMARC"}),"\n",(0,a.jsx)(n.li,{children:"TBD: make it general, so any decentralized, verifiable system can be used"}),"\n"]}),"\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"Field"}),(0,a.jsx)(n.th,{children:"Description"})]})}),(0,a.jsxs)(n.tbody,{children:[(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"chain.id"}),(0,a.jsx)(n.td,{children:"chain identifier"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"chain.name"}),(0,a.jsx)(n.td,{children:"chain name"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"chain.uri"}),(0,a.jsx)(n.td,{children:"URI pointing to chain info"})]})]})]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"chain info - JSON object containing the information needed to verify the email protocol, like API endpoints for querying DNS records [TBD]"}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"provable-email-registry",children:(0,a.jsx)(n.code,{children:"Provable-Email-Registry"})}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["a decentralized registry where email body hashes ",(0,a.jsx)(n.code,{children:"bh"}),", ",(0,a.jsx)(n.code,{children:"Message-ID"}),", and signature hashes (e.g. DKIM-Signature, ARC headers signatures) can be registered for authentication verification. While respecting user privacy."]}),"\n",(0,a.jsx)(n.li,{children:"users may also register their consent for their emails to be forwarded or not, or to be notified when a provable forward happens."}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"provable-forward-origin-dkim-context",children:(0,a.jsx)(n.code,{children:"Provable-Forward-Origin-DKIM-Context"})}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"original email context used to verify the original DKIM-Signature - any headers that have to be modified by the forwarding process"}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"Subject\nFrom\nTo\nCc\n....TBD\n"})}),"\n",(0,a.jsx)(n.h3,{id:"provable-forward-signature",children:(0,a.jsx)(n.code,{children:"Provable-Forward-Signature"})}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"chain of email addresses & DKIM hashes/signatures"}),"\n"]}),"\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"Field"}),(0,a.jsx)(n.th,{children:"Description"})]})}),(0,a.jsxs)(n.tbody,{children:[(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"v"}),(0,a.jsx)(n.td,{children:"version"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"i"}),(0,a.jsx)(n.td,{children:"instance number"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"f"}),(0,a.jsx)(n.td,{children:"forwarder email address"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"a"}),(0,a.jsx)(n.td,{children:"hash algorithm"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"x"}),(0,a.jsx)(n.td,{children:"DKIM-Signature hash"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"h"}),(0,a.jsx)(n.td,{children:"signed headers"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"b"}),(0,a.jsx)(n.td,{children:"signature"})]})]})]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"should be signed:"}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"original DKIM-Signature hash?\noriginal ARC-Message-Signature hash?\noriginal ARC-Authentication-Results hash?\noriginal ARC-Seal hash?\nARC-Authentication-Results // TBD do we need this? from received/forwarded email\nprevious Provable-Forward-Signature\n"})}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"ensures previous headers are not removed, or previous forwarder signatures."}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"Provable-Forward-Chain: i=1; a=sha256; f=my@email.com>; x=<hash>\n    h=\n    b=<signature>\n"})}),"\n",(0,a.jsx)(n.h3,{id:"notes",children:"Notes:"}),"\n",(0,a.jsxs)(n.p,{children:["Forwarding also registers in the email registry, linked to the original ",(0,a.jsx)(n.code,{children:"DKIM-Signature"})," hash, ",(0,a.jsx)(n.code,{children:"bh"}),", ",(0,a.jsx)(n.code,{children:"MessageID"}),", and maybe header hash:"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"your DKIM-Signature hash"}),"\n",(0,a.jsxs)(n.li,{children:["new ",(0,a.jsx)(n.code,{children:"Message-ID"})]}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"DKIM-Signature"})," must contain in the ",(0,a.jsx)(n.code,{children:"h"})," field:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"From\nTo\nCc\nBcc\nReply-To\nReferences\nIn-Reply-To\nSubject\nDate\nMessage-Id\nContent-Type\n"})}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"ensures context integrity when forwarding an email contained in a thread"}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"extensions",children:"Extensions"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"time-based ordering, proving time"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>d,x:()=>l});var r=i(6540);const a={},s=r.createContext(a);function d(e){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:d(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);