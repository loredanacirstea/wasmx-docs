<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-architecture/provable_email_forwarding" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Provable Email Forwarding | wasmX</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" property="og:url" content="https://wasmx.provable.dev/docs/architecture/provable_email_forwarding"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="author" content="WasmX Team"><meta data-rh="true" name="theme-color" content="#4a5568"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" name="twitter:site" content="@lorecirstea"><meta data-rh="true" name="og:type" content="website"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Provable Email Forwarding | wasmX"><meta data-rh="true" name="description" content="Provable Manual Email Forwarding (user-triggered)"><meta data-rh="true" property="og:description" content="Provable Manual Email Forwarding (user-triggered)"><meta data-rh="true" name="keywords" content="SPF,DKIM,DMARC,ARC,email,Sender Policy Framework,DomainKeys Identified Mail,Domain-based Message Authentication,Authenticated Received Chain,cryptography,forwarding,email forwarding"><meta data-rh="true" property="og:image" content="https://wasmx.provable.dev/img/email1.png"><meta data-rh="true" name="twitter:image" content="https://wasmx.provable.dev/img/email1.png"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://wasmx.provable.dev/docs/architecture/provable_email_forwarding"><link data-rh="true" rel="alternate" href="https://wasmx.provable.dev/docs/architecture/provable_email_forwarding" hreflang="en"><link data-rh="true" rel="alternate" href="https://wasmx.provable.dev/docs/architecture/provable_email_forwarding" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Provable Email Forwarding","item":"https://wasmx.provable.dev/docs/architecture/provable_email_forwarding"}]}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="wasmX RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="wasmX Atom Feed">





<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto+Condensed&amp;display=swap">
<script type="application/ld+json">{"@context":"https://schema.org/","@type":"WebSite","name":"wasmX: the only WASM-modular blockchain engine capable of regeneration and metamorphosis","description":"wasmX: the only WASM-modular blockchain engine capable of regeneration and metamorphosis","url":"https://wasmx.provable.dev","logo":"https://wasmx.provable.dev/img/wasmx.png"}</script>
<script type="application/ld+json">{"@context":"https://schema.org/","@type":"SoftwareApplication","name":"WasmX","alternateName":["WasmX","MythosX"],"operatingSystem":"Cross-platform","applicationCategory":"DeveloperApplication","url":"https://wasmx.provable.dev","description":"wasmX is the most flexible WebAssembly-based execution engine for smart contracts."}</script><link rel="stylesheet" href="/assets/css/styles.752ccb6d.css">
<script src="/assets/js/runtime~main.4f63cae8.js" defer="defer"></script>
<script src="/assets/js/main.b0691532.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="wasmX logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="wasmX logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">wasmX</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/category/overview">overview</a><a class="navbar__item navbar__link" href="/blog">blog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/ark-us/wasmx" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/overview">overview</a><button aria-label="Expand sidebar category &#x27;overview&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/demos">demos</a><button aria-label="Expand sidebar category &#x27;demos&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/host-apis">host apis</a><button aria-label="Expand sidebar category &#x27;host apis&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/architecture/provable_email_forwarding">architecture</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/architecture/provable_email_forwarding">Provable Email Forwarding</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/architecture/email">Email Verification Protocols</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">architecture</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Provable Email Forwarding</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Provable Email Forwarding</h1></header>
<p>wasmX offers email verification standards for truly provable email.</p>
<p><a href="/docs/architecture/email">Current standards</a> are not enough.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="prelude">Prelude<a href="#prelude" class="hash-link" aria-label="Direct link to Prelude" title="Direct link to Prelude">​</a></h2>
<ul>
<li>
<p>header registry:
<a href="https://www.iana.org/assignments/message-headers/message-headers.xhtml" target="_blank" rel="noopener noreferrer">https://www.iana.org/assignments/message-headers/message-headers.xhtml</a></p>
</li>
<li>
<p>deprecating <code>X-</code> prefix for custom headers <a href="https://datatracker.ietf.org/doc/html/rfc6648" target="_blank" rel="noopener noreferrer">https://datatracker.ietf.org/doc/html/rfc6648</a>. Just use a unique and relevant prefix.</p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="technical-demo-video">Technical Demo Video<a href="#technical-demo-video" class="hash-link" aria-label="Direct link to Technical Demo Video" title="Direct link to Technical Demo Video">​</a></h2>
<p>A 15 minute video with: explanation of why this is needed, technical summary, prototype demo with a custom email server doing multiple hops of forwarding.</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/5eWQqwad8wA?si=lgUuPgAo6USA38qD" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin"></iframe>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="manual-forwarding-now">Manual Forwarding Now<a href="#manual-forwarding-now" class="hash-link" aria-label="Direct link to Manual Forwarding Now" title="Direct link to Manual Forwarding Now">​</a></h2>
<p>Current standards for <a href="/docs/architecture/email#manual-forwarding">manual email forwarding</a> do not allow users to verify the authenticity of a forwarded email. The email body is often changed by the email client itself.</p>
<p><strong>Why bother?</strong>: Because society needs provability in order to have peace. And if communications are provable digitally, it reduces the need for abusive institutions to seize devices that may be an intrinsic part of your identity and everyday life.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="provable-manual-forwarding-with-custom-headers--decentralized-registries">Provable Manual Forwarding with Custom Headers &amp; Decentralized Registries<a href="#provable-manual-forwarding-with-custom-headers--decentralized-registries" class="hash-link" aria-label="Direct link to Provable Manual Forwarding with Custom Headers &amp; Decentralized Registries" title="Direct link to Provable Manual Forwarding with Custom Headers &amp; Decentralized Registries">​</a></h2>
<p>We have created a protocol that is heavily inspired from the ARC protocol, for automatic forwarding. However, manual forwarding requires some headers to change (compared to the original, forwarded email) - like <code>From</code>, <code>To</code>, etc. Also, in the case of ARC, DNS key rotation will make it impossible to verify DKIM and ARC signatures and forwarding will eventually fail. Our <code>Provable-Forward</code> protocol solves these issues.</p>
<ul>
<li>DNS key rotation is solved by keeping historical DNS public keys on a verifiable decentralized system</li>
</ul>
<p><strong>PROs:</strong></p>
<ul>
<li>can verify original email authenticity</li>
<li>provable intermediary chain (intermediary privacy concerns can be mitigated by email consent registries)</li>
<li>maintain compatibility with current email verification checks, so emails are not marked as invalid or spam</li>
<li>can work even without MTA support (custom headers can be produced by MUAs, with user-controlled keys and blockchain-published public keys) -&gt; decentralization of protocol -&gt; users can choose individually</li>
<li>historical email verification for <code>DKIM</code>, <code>ARC</code> and <code>PROVABLE</code> headers</li>
<li>maintains the integrity of context/thread by including the <code>References</code> of previous emails.</li>
</ul>
<p><strong>CONs:</strong></p>
<ul>
<li>needs end-user email clients (MUAs) support or plugins, but it is time to upgrade the email experience anyway.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="unchanged">Unchanged<a href="#unchanged" class="hash-link" aria-label="Direct link to Unchanged" title="Direct link to Unchanged">​</a></h3>
<ul>
<li>email body remains the same -&gt; <code>bh</code> remains the same across all forwards</li>
<li>headers:</li>
</ul>
<div class="language-email codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-email codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">MIME-Version</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Content-Type</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Content-Transfer-Encoding</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="changed-headers-by-forwarding-mta">Changed Headers by Forwarding MTA<a href="#changed-headers-by-forwarding-mta" class="hash-link" aria-label="Direct link to Changed Headers by Forwarding MTA" title="Direct link to Changed Headers by Forwarding MTA">​</a></h3>
<div class="language-email codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-email codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">From</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">To</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Cc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Bcc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Date</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Message-ID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Subject</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">References</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">In-Reply-To</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="added-headers-by-forwarding-mta">Added Headers by Forwarding MTA<a href="#added-headers-by-forwarding-mta" class="hash-link" aria-label="Direct link to Added Headers by Forwarding MTA" title="Direct link to Added Headers by Forwarding MTA">​</a></h3>
<div class="language-email codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-email codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Provable-Authentication-Results</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Provable-Forward-DKIM-Context</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Provable-Forward-Signature</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Provable-Forward-Seal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Provable-Forward-Check</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="provable-authentication-results"><code>Provable-Authentication-Results</code><a href="#provable-authentication-results" class="hash-link" aria-label="Direct link to provable-authentication-results" title="Direct link to provable-authentication-results">​</a></h3>
<ul>
<li>similar to ARC&#x27;s <code>Authentication-Results</code> header</li>
<li>it can be computed when an email is received, or, it may be computed before an email is forwarded (using the DNS registry with historical DKIM public keys)</li>
</ul>
<div class="language-email codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-email codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Provable-Authentication-Results: i=1; dmail.provable.dev;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	 dkim=pass header.d=dmail.provable.dev; spf=pass smtp.mailfrom=test@dmail.provable.dev; dmarc=pass header.from=dmail.provable.dev</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="provable-forward-dkim-context"><code>Provable-Forward-DKIM-Context</code><a href="#provable-forward-dkim-context" class="hash-link" aria-label="Direct link to provable-forward-dkim-context" title="Direct link to provable-forward-dkim-context">​</a></h3>
<ul>
<li>email context used to verify the forwarded email&#x27;s DKIM-Signature - contains any headers that have to be modified by the forwarding process</li>
<li>TBD: we may consider a similar approach for maintaining original ARC headers too, so we can have the entire forwarding path (automatic forwarding and manual)</li>
</ul>
<table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td><code>i</code></td><td>instance number</td></tr><tr><td><code>&lt;header_name&gt;</code></td><td><code>&lt;header_value&gt;</code></td></tr></tbody></table>
<ul>
<li><code>header_name</code> can be:</li>
</ul>
<div class="language-email codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-email codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">DKIM-Signature</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Message-ID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Subject</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">From</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">To</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Cc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Bcc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Date</span><br></span></code></pre></div></div>
<ul>
<li><code>DKIM-Signature</code> is base64 encoded</li>
<li><code>Subject</code> is URI encoded</li>
<li>other header values are kept as in the original headers, but any spaces and <code>\r\n</code> characters are stripped.</li>
</ul>
<div class="language-email codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-email codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Provable-Forward-DKIM-Context: i=1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> DKIM-Signature=dj0xOyBkPWRtYWlsLnByb3ZhYmxlLmRldjsgcz0yMDI1YTsNCglpPXRlc3RAZG1haWwucHJvdmFibGUuZGV2OyBhPXJzYS1zaGEyNTY7IGM9cmVsYXhlZC9yZWxheGVkOyB0PTA7IGg9RnJvbTpUbzoNCglDYzpCY2M6UmVwbHktVG86UmVmZXJlbmNlczpJbi1SZXBseS1UbzpTdWJqZWN0OkRhdGU6TWVzc2FnZS1JRDoNCglDb250ZW50LVR5cGU7IGJoPVFmLzBNaEg2WXNSNWlhT0RsdXoxOVJtaG84eHlJMkRRdmRPV0dWM2NOcDg9OyBiPU00NHdsTUwvcVMNCgl3UDY4dlJCbHhtKzhlN0Q3R3kyeVFEOHRuTVpiQWdkTXhWWFZqMFRzTk1yNjVxRFZkL2ROc3J6U2ZPdXgrWnVFOFo5WTl6Vlhpa2INCgl4U3J6TWdLLzhGSFQwaWhXc3FpWlpvTHV2bTdCeFFDY21QVERlcmJYV0NDYUhJYzdVUHlBNEcwdGt2aEM2TzZGRFZtOEVGOWE1YnINCgl1WnMybUZ1VDFoOD0=;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> Date=Fri, 25 Jul 2025 19:41:46 +0000;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> From=test@dmail.provable.dev;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> Message-ID=&lt;2275ea76901e8668754397460cc1fd78f5.1753472506228210000@2025a.dmail.provable.dev&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> Subject=this+is+an+email;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> To=test2@dmail.provable.dev;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="provable-forward-signature"><code>Provable-Forward-Signature</code><a href="#provable-forward-signature" class="hash-link" aria-label="Direct link to provable-forward-signature" title="Direct link to provable-forward-signature">​</a></h3>
<ul>
<li>similar to <code>DKIM-Signature</code>, this signature signs on the original body and headers that are being forwarded</li>
<li>allows the <code>Subject</code>, <code>From</code>, <code>Date</code>, <code>To</code> etc. to be modified, by caching them in the <code>Provable-Forward-DKIM-Context</code> header and signing over this header.</li>
</ul>
<table><thead><tr><th>Tag</th><th>Name</th><th>Description</th></tr></thead><tbody><tr><td><code>v</code></td><td>Version</td><td><code>1</code></td></tr><tr><td><code>i</code></td><td>Instance</td><td>instance number</td></tr><tr><td><code>dnsregistry</code></td><td>DNS Registry</td><td>dns registry historical records for DKIM public keys</td></tr><tr><td><code>emailregistry</code></td><td>Email Registry</td><td>email registry for user consent, etc.</td></tr><tr><td><code>a</code></td><td>Algorithm</td><td>The cryptographic algorithm used to generate the signature, e.g. <code>rsa-sha256</code> or <code>ed25519-sha256</code>.</td></tr><tr><td><code>d</code></td><td>Domain</td><td>SDID: the signing domain (<code>d=</code>) whose DNS contains the public key under <code>selector._domainkey.domain</code> (e.g. <a href="https://dns.google/resolve?type=TXT&amp;name=2024a._domainkey.mail.provable.dev" target="_blank" rel="noopener noreferrer">2024a._domainkey.mail.provable.dev</a>)</td></tr><tr><td><code>h</code></td><td>Signed Headers</td><td>A colon-separated list of headers that were signed (in order), e.g. <code>Provable-Forward-DKIM-Context</code>.</td></tr><tr><td><code>s</code></td><td>Selector</td><td>Indicates the DNS record selector under <code>_domainkey</code>, e.g. <code>s=2024a</code> → <code>2024a._domainkey.mail.provable.dev</code> (e.g. <a href="https://dns.google/resolve?type=TXT&amp;name=2024a._domainkey.mail.provable.dev" target="_blank" rel="noopener noreferrer">2024a._domainkey.mail.provable.dev</a>.</td></tr><tr><td><code>bh</code></td><td>Body Hash</td><td>Base64-encoded hash of the canonicalized body; used to verify the body wasn&#x27;t modified.</td></tr><tr><td><code>b</code></td><td>Signature</td><td>The actual Base64-encoded digital signature (generated using the private key).</td></tr></tbody></table>
<ul>
<li>example</li>
</ul>
<div class="language-email codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-email codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Provable-Forward-Signature: i=1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> d=dmail.provable.dev;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> s=2025a;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> a=rsa-sha256;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c=relaxed/relaxed;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> h=Provable-Forward-DKIM-Context;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> bh=Qf/0MhH6YsR5iaODluz19Rmho8xyI2DQvdOWGV3cNp8=;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> dnsregistry=someurl;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> emailregistry=someurl;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> b=LbAycOdLIQ6WdPhcRsZn+g+EkWEHNolthWjhZD/iSYwoUoV3/N</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> DA65HiTO+zxLJoiKQ/RJdxGq3HzOF+j/sQDZiPnv4fyy1OLMsEnz7fjG6Ns2Ckd1BlGItU45H9a WPzzFb79yGMifPddE/bB+uN913stI3ucv6kAECkPwCg3Dg=</span><br></span></code></pre></div></div>
<ul>
<li>TBD: original ARC headers - full or hash?</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="dnsregistry"><code>dnsregistry</code><a href="#dnsregistry" class="hash-link" aria-label="Direct link to dnsregistry" title="Direct link to dnsregistry">​</a></h4>
<ul>
<li>a decentralized DNS registry with current and historical DNS records, for verifying DKIM, SPF, DMARC</li>
<li>TBD: make it general, so any decentralized, verifiable system can be used</li>
</ul>
<table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td>chain.id</td><td>chain identifier</td></tr><tr><td>chain.name</td><td>chain name</td></tr><tr><td>chain.uri</td><td>URI pointing to chain info</td></tr></tbody></table>
<ul>
<li>it may become a header, or just a header field</li>
<li>chain info - JSON object containing the information needed to verify the email protocol, like API endpoints for querying DNS records [TBD]</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="emailregistry"><code>emailregistry</code><a href="#emailregistry" class="hash-link" aria-label="Direct link to emailregistry" title="Direct link to emailregistry">​</a></h4>
<ul>
<li>a decentralized registry where email body hashes <code>bh</code>, <code>Message-ID</code>, and signature hashes (e.g. DKIM-Signature, ARC headers signatures) can be registered for authentication verification. While respecting user privacy.</li>
<li>users may also register their consent for their emails to be forwarded or not, or to be notified when a provable forward happens.</li>
<li>it may become a header, or just a header field</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="provable-forward-seal"><code>Provable-Forward-Seal</code><a href="#provable-forward-seal" class="hash-link" aria-label="Direct link to provable-forward-seal" title="Direct link to provable-forward-seal">​</a></h3>
<ul>
<li>similar to <code>ARC-Seal</code></li>
</ul>
<table><thead><tr><th>Field</th><th>Description</th><th>Example</th><th>Required</th></tr></thead><tbody><tr><td><code>i</code></td><td>instance number. Must match the corresponding <code>i=</code> in Provable-Authentication-Results and Provable-Forward-Signature.</td><td><code>i=1</code></td><td>Yes</td></tr><tr><td><code>a</code></td><td>Algorithm used to generate the signature. Format: <code>&lt;algorithm&gt;-&lt;hash&gt;</code>.</td><td><code>a=rsa-sha256</code></td><td>Yes</td></tr><tr><td><code>d</code></td><td>Domain of the sealing entity (signer). Used with <code>s=</code> to retrieve the public key.</td><td><code>d=example.org</code></td><td>Yes</td></tr><tr><td><code>s</code></td><td>Selector used to locate the public key in DNS.</td><td><code>s=selector1</code></td><td>Yes</td></tr><tr><td><code>t</code></td><td>Signing timestamp (seconds since epoch).</td><td><code>t=1650000000</code></td><td>Yes</td></tr><tr><td><code>cv</code></td><td>Chain validation result for previous Provable sets. Values: <code>none</code>, <code>pass</code>, or <code>fail</code>.</td><td><code>cv=none</code></td><td>Yes</td></tr><tr><td><code>b</code></td><td>Signature value (base64-encoded). Empty (<code>b=</code>) when computing the hash.</td><td><code>b=abc123...</code></td><td>Yes</td></tr></tbody></table>
<ul>
<li>
<p>the canonicalization for <code>Provable-Forward-Seal</code> is always relaxed (c= is not specified).</p>
</li>
<li>
<p><code>Provable-Forward-Seal</code> signs over:</p>
<ul>
<li>the current <code>Provable-Authentication-Results</code></li>
<li>the current <code>Provable-Forward-Signature</code></li>
<li>all prior <code>Provable-Forward-Seal</code>s (not including the current one)</li>
</ul>
</li>
<li>
<p>example</p>
</li>
</ul>
<div class="language-email codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-email codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Provable-Forward-Seal: i=1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> d=dmail.provable.dev;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> s=2025a;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> a=rsa-sha256;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> cv=none;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> t=1753472514;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> b=wg0xyDX+jk9ajgu1zChYvWvZsam0M39KFtYlRQ701cCWjARetB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 6/8ZXzmCJX5aWWGXOHY7E7lU8WgHf//s5gqYw/HcKEywotb3sY6TiMo5yLlFYiyTYaBJN0VTPsY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> DmPqvNe6Syq8zRUPe2t17k0nPf/apE70j4BVMW0Fs5cMA8=</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="provable-forward-check"><code>Provable-Forward-Check</code><a href="#provable-forward-check" class="hash-link" aria-label="Direct link to provable-forward-check" title="Direct link to provable-forward-check">​</a></h3>
<ul>
<li>an optional check that can be added when a forwarded email is received, that checks if all protocol verifications have passed and the forwarded email is authentic</li>
<li>can be done by email servers, MTAs, email clients capable of verifying</li>
</ul>
<div class="language-email codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-email codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Provable-Forward-Check: pass; agent=myemailagent;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="notes-to-be-considered">Notes to be considered:<a href="#notes-to-be-considered" class="hash-link" aria-label="Direct link to Notes to be considered:" title="Direct link to Notes to be considered:">​</a></h3>
<p>Forwarding can also register hashes in the email registry, linked to the original <code>DKIM-Signature</code> hash, <code>bh</code>, <code>MessageID</code>, and maybe header hash:</p>
<ul>
<li>your DKIM-Signature hash</li>
<li>new <code>Message-ID</code></li>
</ul>
<p><code>DKIM-Signature</code> must contain in the <code>h</code> field:</p>
<div class="language-email codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-email codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">From</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">To</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Cc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Bcc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Reply-To</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">References</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">In-Reply-To</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Subject</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Date</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Message-Id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Content-Type</span><br></span></code></pre></div></div>
<ul>
<li>the above also ensures context integrity when forwarding an email contained in a thread</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="extensions">Extensions<a href="#extensions" class="hash-link" aria-label="Direct link to Extensions" title="Direct link to Extensions">​</a></h3>
<ul>
<li>time-based ordering, proving time</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/loredanacirstea/wasmx-docs/tree/main/docs/architecture/provable_email_forwarding.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/apis/wasmx"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">wasmx</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/architecture/email"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Email Verification Protocols</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#prelude" class="table-of-contents__link toc-highlight">Prelude</a></li><li><a href="#technical-demo-video" class="table-of-contents__link toc-highlight">Technical Demo Video</a></li><li><a href="#manual-forwarding-now" class="table-of-contents__link toc-highlight">Manual Forwarding Now</a></li><li><a href="#provable-manual-forwarding-with-custom-headers--decentralized-registries" class="table-of-contents__link toc-highlight">Provable Manual Forwarding with Custom Headers &amp; Decentralized Registries</a><ul><li><a href="#unchanged" class="table-of-contents__link toc-highlight">Unchanged</a></li><li><a href="#changed-headers-by-forwarding-mta" class="table-of-contents__link toc-highlight">Changed Headers by Forwarding MTA</a></li><li><a href="#added-headers-by-forwarding-mta" class="table-of-contents__link toc-highlight">Added Headers by Forwarding MTA</a></li><li><a href="#provable-authentication-results" class="table-of-contents__link toc-highlight"><code>Provable-Authentication-Results</code></a></li><li><a href="#provable-forward-dkim-context" class="table-of-contents__link toc-highlight"><code>Provable-Forward-DKIM-Context</code></a></li><li><a href="#provable-forward-signature" class="table-of-contents__link toc-highlight"><code>Provable-Forward-Signature</code></a></li><li><a href="#provable-forward-seal" class="table-of-contents__link toc-highlight"><code>Provable-Forward-Seal</code></a></li><li><a href="#provable-forward-check" class="table-of-contents__link toc-highlight"><code>Provable-Forward-Check</code></a></li><li><a href="#notes-to-be-considered" class="table-of-contents__link toc-highlight">Notes to be considered:</a></li><li><a href="#extensions" class="table-of-contents__link toc-highlight">Extensions</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/overview/introduction">Overview</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discord.gg/8W5jeBke4f" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://x.com/lorecirstea" target="_blank" rel="noopener noreferrer" class="footer__link-item">X<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Dev</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/ark-us/wasmx" target="_blank" rel="noopener noreferrer" class="footer__link-item">wasmX<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/loredanacirstea/wasmx-docs" target="_blank" rel="noopener noreferrer" class="footer__link-item">wasmx docs<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 wasmX. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>