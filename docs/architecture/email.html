<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-architecture/email" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Email Verification Protocols | wasmX</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" property="og:url" content="https://wasmx.provable.dev/docs/architecture/email"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="author" content="WasmX Team"><meta data-rh="true" name="theme-color" content="#4a5568"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" name="twitter:site" content="@lorecirstea"><meta data-rh="true" name="og:type" content="website"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Email Verification Protocols | wasmX"><meta data-rh="true" name="description" content="Email Verification Protocols (SPF, DKIM, DMARC, ARC)"><meta data-rh="true" property="og:description" content="Email Verification Protocols (SPF, DKIM, DMARC, ARC)"><meta data-rh="true" name="keywords" content="SPF,DKIM,DMARC,ARC,email,Sender Policy Framework,DomainKeys Identified Mail,Domain-based Message Authentication,Authenticated Received Chain,cryptography"><meta data-rh="true" property="og:image" content="https://wasmx.provable.dev/img/email1.png"><meta data-rh="true" name="twitter:image" content="https://wasmx.provable.dev/img/email1.png"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://wasmx.provable.dev/docs/architecture/email"><link data-rh="true" rel="alternate" href="https://wasmx.provable.dev/docs/architecture/email" hreflang="en"><link data-rh="true" rel="alternate" href="https://wasmx.provable.dev/docs/architecture/email" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Email Verification Protocols","item":"https://wasmx.provable.dev/docs/architecture/email"}]}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="wasmX RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="wasmX Atom Feed">





<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto+Condensed&amp;display=swap">
<script type="application/ld+json">{"@context":"https://schema.org/","@type":"WebSite","name":"wasmX: the only WASM-modular blockchain engine capable of regeneration and metamorphosis","description":"wasmX: the only WASM-modular blockchain engine capable of regeneration and metamorphosis","url":"https://wasmx.provable.dev","logo":"https://wasmx.provable.dev/img/wasmx.png"}</script>
<script type="application/ld+json">{"@context":"https://schema.org/","@type":"SoftwareApplication","name":"WasmX","alternateName":["WasmX","MythosX"],"operatingSystem":"Cross-platform","applicationCategory":"DeveloperApplication","url":"https://wasmx.provable.dev","description":"wasmX is the most flexible WebAssembly-based execution engine for smart contracts."}</script><link rel="stylesheet" href="/assets/css/styles.752ccb6d.css">
<script src="/assets/js/runtime~main.bf8e91ed.js" defer="defer"></script>
<script src="/assets/js/main.3ff217d1.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="wasmX logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="wasmX logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">wasmX</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/category/overview">overview</a><a class="navbar__item navbar__link" href="/blog">blog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/loredanacirstea/wasmx-docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/overview">overview</a><button aria-label="Expand sidebar category &#x27;overview&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/demos">demos</a><button aria-label="Expand sidebar category &#x27;demos&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/host-apis">host apis</a><button aria-label="Expand sidebar category &#x27;host apis&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/architecture/provable_email_forwarding">architecture</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/architecture/provable_email_forwarding">Provable Email Forwarding</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/architecture/email">Email Verification Protocols</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">architecture</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Email Verification Protocols</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Email Verification Protocols Now</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="spf-sender-policy-framework">SPF (Sender Policy Framework)<a href="#spf-sender-policy-framework" class="hash-link" aria-label="Direct link to SPF (Sender Policy Framework)" title="Direct link to SPF (Sender Policy Framework)">​</a></h2>
<p><a href="https://datatracker.ietf.org/doc/html/rfc7208" target="_blank" rel="noopener noreferrer">https://datatracker.ietf.org/doc/html/rfc7208</a></p>
<ul>
<li><code>MAILFROM</code> set by SMTP email sender</li>
<li><code>IP</code></li>
</ul>
<p>SMTP email receiver queries the SPF record for the <code>MAIL FROM</code> domain and checks that <code>IP</code> is authorized.</p>
<p>SPF record example for <a href="https://dns.google/resolve?type=TXT&amp;name=mail.provable.dev" target="_blank" rel="noopener noreferrer">mail.provable.dev</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="dkim-domainkeys-identified-mail">DKIM (DomainKeys Identified Mail)<a href="#dkim-domainkeys-identified-mail" class="hash-link" aria-label="Direct link to DKIM (DomainKeys Identified Mail)" title="Direct link to DKIM (DomainKeys Identified Mail)">​</a></h2>
<ul>
<li><a href="https://datatracker.ietf.org/doc/html/rfc6376" target="_blank" rel="noopener noreferrer">https://datatracker.ietf.org/doc/html/rfc6376</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="required-dkim-signature-tags">Required DKIM Signature Tags<a href="#required-dkim-signature-tags" class="hash-link" aria-label="Direct link to Required DKIM Signature Tags" title="Direct link to Required DKIM Signature Tags">​</a></h3>
<table><thead><tr><th>Tag</th><th>Name</th><th>Description</th></tr></thead><tbody><tr><td><code>v</code></td><td>Version</td><td><code>1</code> for rfc6376</td></tr><tr><td><code>a</code></td><td>Algorithm</td><td>The cryptographic algorithm used to generate the signature, e.g. <code>rsa-sha256</code> or <code>ed25519-sha256</code>.</td></tr><tr><td><code>b</code></td><td>Signature</td><td>The actual Base64-encoded digital signature (generated using the private key).</td></tr><tr><td><code>bh</code></td><td>Body Hash</td><td>Base64-encoded hash of the canonicalized body; used to verify the body wasn&#x27;t modified.</td></tr><tr><td><code>d</code></td><td>Domain</td><td>SDID: the signing domain (<code>d=</code>) whose DNS contains the public key under <code>selector._domainkey.domain</code> (e.g. <a href="https://dns.google/resolve?type=TXT&amp;name=2024a._domainkey.mail.provable.dev" target="_blank" rel="noopener noreferrer">2024a._domainkey.mail.provable.dev</a>)</td></tr><tr><td><code>h</code></td><td>Signed Headers</td><td>A colon-separated list of headers that were signed (in order), e.g. <code>from:to:subject</code>.</td></tr><tr><td><code>s</code></td><td>Selector</td><td>Indicates the DNS record selector under <code>_domainkey</code>, e.g. <code>s=2024a</code> → <code>2024a._domainkey.mail.provable.dev</code> (e.g. <a href="https://dns.google/resolve?type=TXT&amp;name=2024a._domainkey.mail.provable.dev" target="_blank" rel="noopener noreferrer">2024a._domainkey.mail.provable.dev</a>.</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="optional-dkim-signature-tags">Optional DKIM Signature Tags<a href="#optional-dkim-signature-tags" class="hash-link" aria-label="Direct link to Optional DKIM Signature Tags" title="Direct link to Optional DKIM Signature Tags">​</a></h3>
<table><thead><tr><th>Tag</th><th>Name</th><th>Description</th></tr></thead><tbody><tr><td><code>c</code></td><td>Canonicalization Algorithm</td><td>Header/body canonicalization, e.g. <code>relaxed/relaxed</code>, <code>simple/simple</code>. Default is <code>simple/simple</code>.</td></tr><tr><td><code>i</code></td><td>Identity</td><td>AUID (User identifier), e.g. <code>i=@example.com</code> or <code>i=user@example.com</code>. Must be a subdomain or exact match of <code>d=</code>.</td></tr><tr><td><code>l</code></td><td>Body Length Count</td><td>Number of body bytes hashed (used for partial signing). Rarely used.</td></tr><tr><td><code>q</code></td><td>Query Method</td><td>How to retrieve the public key. Usually just <code>dns/txt</code>. Deprecated and ignored by most systems.</td></tr><tr><td><code>t</code></td><td>Timestamp</td><td>Integer (Unix timestamp) when the signature was created.</td></tr><tr><td><code>x</code></td><td>Expiration</td><td>Integer (Unix timestamp) after which the signature is no longer valid.</td></tr><tr><td><code>z</code></td><td>Copied Headers</td><td>Original headers (folded) to aid debugging; optional and rarely used.</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="h-signed-headers"><code>h=</code> signed headers<a href="#h-signed-headers" class="hash-link" aria-label="Direct link to h-signed-headers" title="Direct link to h-signed-headers">​</a></h3>
<ul>
<li>required: <code>From</code></li>
<li>recommended: <code>From:To:Cc:Subject:Date:Message-ID:Content-Type:Content-Transfer-Encoding</code></li>
</ul>
<div class="language-email codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-email codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">DKIM-Signature: v=1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  d=mail.provable.dev;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  s=2024a;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  i=test@mail.provable.dev;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  a=ed25519-sha256;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  t=1749589922;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  x=1749849122;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  h=From:To:Cc:Bcc:Reply-To: References:In-Reply-To:Subject:Date:Message-Id:Content-Type:From:To:Subject: Date:Message-Id:Content-Type;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  bh=4fWAjR8dybJoJ7oc+ua358Qnylv7LASFrox6UiJwQ8g=;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  b=7J39El5KDL4NPguv2fK3m7xm/F</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    evJN9QFqECm90XGwfWnlqBEEjHteY/P28AJ5xwfenf08TdtBLIMes6PMZTBA==</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DKIM-Signature: v=1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  d=mail.provable.dev;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  s=2024b;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  i=test@mail.provable.dev;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  a=rsa-sha256;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  t=1749589922;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  x=1749849122;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  h=From:To:Cc:Bcc:Reply-To: References:In-Reply-To:Subject:Date:Message-Id:Content-Type:From:To:Subject: Date:Message-Id:Content-Type;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  bh=4fWAjR8dybJoJ7oc+ua358Qnylv7LASFrox6UiJwQ8g=;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  b=K043WB+2sby57d3sihT+xRSou8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    H2+XTKqUxrfBRaOa6q48hcUs7DVg9n+0bA6T7cAQYlNsc1MNoViH5ebdjYKigJepnwrh4CCGweJUZ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    plhBWUF2McU4Kgz8XaLyCt5ipots2aOLRG7yT0FkudXYBY2bnG64fbyQABf6LClIF9Gwuq8gNF5Mj</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    YF+oZZCZdnsQnf/AT+qDYCjOgTbjoPosZDOypsHSu42/m12UsYEqAZsBrsqaFV1rmFLlpdWzQ8y41</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dySACyWpRiVayzU5vFvfBkd/juhG94xlER9cs8RLE/oeFXqtOqq21HDUfqLp3koxqOeHTgmctN/0r</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    BI+nuopA==</span><br></span></code></pre></div></div>
<p>Allows the sender&#x27;s mail server to digitally sign email messages using their domain&#x27;s private key. The recipient’s mail server can then verify the signature using the public key published in DNS, ensuring:</p>
<ul>
<li>The email was not altered in transit.</li>
<li>It was authorized by the domain it claims to be from.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="dmarc-domain-based-message-authentication-reporting-and-conformance">DMARC (Domain-based Message Authentication, Reporting and Conformance)<a href="#dmarc-domain-based-message-authentication-reporting-and-conformance" class="hash-link" aria-label="Direct link to DMARC (Domain-based Message Authentication, Reporting and Conformance)" title="Direct link to DMARC (Domain-based Message Authentication, Reporting and Conformance)">​</a></h2>
<ul>
<li><a href="https://datatracker.ietf.org/doc/html/rfc7489" target="_blank" rel="noopener noreferrer">https://datatracker.ietf.org/doc/html/rfc7489</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="flow">Flow<a href="#flow" class="hash-link" aria-label="Direct link to Flow" title="Direct link to Flow">​</a></h3>
<!-- -->
<ol>
<li>Check <a href="#dkim-domainkeys-identified-mail">DKIM signature</a></li>
<li>Check <a href="#spf-sender-policy-framework">SPF</a></li>
<li>Check alignment (*required). Domains must match:<!-- -->
<ul>
<li><a href="#from"><code>header.From</code></a> domain</li>
<li><a href="#dkim-domainkeys-identified-mail">DKIM</a> <code>d=</code> domain</li>
<li><a href="#spf-sender-policy-framework">SPF</a> <code>MAILFROM</code> domain</li>
</ul>
</li>
</ol>
<p>If alignment (3) + one of SPF (2) or DKIM (1) passes → DMARC passes</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="arc-authenticated-received-chain">ARC (Authenticated Received Chain)<a href="#arc-authenticated-received-chain" class="hash-link" aria-label="Direct link to ARC (Authenticated Received Chain)" title="Direct link to ARC (Authenticated Received Chain)">​</a></h2>
<ul>
<li><a href="https://datatracker.ietf.org/doc/html/rfc8617" target="_blank" rel="noopener noreferrer">https://datatracker.ietf.org/doc/html/rfc8617</a></li>
<li><a href="https://arc-spec.org/" target="_blank" rel="noopener noreferrer">https://arc-spec.org/</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="flow-1">Flow<a href="#flow-1" class="hash-link" aria-label="Direct link to Flow" title="Direct link to Flow">​</a></h3>
<p>Preserves the results of email authentication checks (SPF, DKIM, DMARC) as a message passes through intermediaries (like mailing lists or forwarders) that might otherwise break those checks — enabling the final recipient to make informed trust decisions even if the message has been modified.</p>
<!-- -->
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="arc-authentication-results">ARC-Authentication-Results<a href="#arc-authentication-results" class="hash-link" aria-label="Direct link to ARC-Authentication-Results" title="Direct link to ARC-Authentication-Results">​</a></h3>
<ul>
<li><a href="https://datatracker.ietf.org/doc/html/rfc8617#section-4.1.1" target="_blank" rel="noopener noreferrer">https://datatracker.ietf.org/doc/html/rfc8617#section-4.1.1</a></li>
</ul>
<p>General syntax: <code>method = result (comment) [ kv-pairs ]</code></p>
<ul>
<li><code>method</code>: e.g., dkim, spf, dmarc</li>
<li><code>result</code>: one of the defined values</li>
<li><code>comment</code>: optional human-readable info</li>
<li><code>kv-pairs</code>: optional, like header.i=...</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="common-methods-and-fields">Common Methods and Fields<a href="#common-methods-and-fields" class="hash-link" aria-label="Direct link to Common Methods and Fields" title="Direct link to Common Methods and Fields">​</a></h4>
<table><thead><tr><th>Method</th><th>Meaning</th><th>Example</th></tr></thead><tbody><tr><td><code>dkim</code></td><td>DKIM signature validation result</td><td><code>dkim=pass header.i=@example.com</code></td></tr><tr><td><code>spf</code></td><td>SPF result for SMTP envelope sender</td><td><code>spf=fail smtp.mailfrom=bad.example.com</code></td></tr><tr><td><code>dmarc</code></td><td>DMARC result (based on SPF &amp; DKIM alignment)</td><td><code>dmarc=pass header.from=example.com</code></td></tr><tr><td><code>arc</code></td><td>ARC chain validation result</td><td><code>arc=pass (i=1 spf=pass dkim=pass dmarc=pass)</code></td></tr><tr><td><code>iprev</code></td><td>Reverse DNS validation</td><td><code>iprev=pass policy.iprev=203.0.113.1</code></td></tr><tr><td><code>auth</code></td><td>Authentication status</td><td><code>auth=pass smtp.auth=user@example.com</code></td></tr><tr><td><code>smtp.mailfrom</code></td><td>The domain in the <code>MAIL FROM</code> envelope</td><td><code>smtp.mailfrom=example.com</code></td></tr><tr><td><code>header.from</code></td><td>The domain in the <code>From:</code> header</td><td><code>header.from=example.com</code></td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="possible-results-for-each-method">Possible Results (for each method):<a href="#possible-results-for-each-method" class="hash-link" aria-label="Direct link to Possible Results (for each method):" title="Direct link to Possible Results (for each method):">​</a></h4>
<table><thead><tr><th>Result</th><th>Meaning</th></tr></thead><tbody><tr><td><code>pass</code></td><td>Authentication succeeded</td></tr><tr><td><code>fail</code></td><td>Authentication failed</td></tr><tr><td><code>neutral</code></td><td>Indeterminate / ambiguous result</td></tr><tr><td><code>none</code></td><td>No data / method not applied</td></tr><tr><td><code>temperror</code></td><td>Temporary error</td></tr><tr><td><code>permerror</code></td><td>Permanent error (e.g., malformed DNS)</td></tr></tbody></table>
<div class="language-email codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-email codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ARC-Authentication-Results: i=3; mx.google.com;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dkim=neutral (no key) header.i=@mail.provable.dev header.s=2024a;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dkim=pass header.i=@mail.provable.dev header.s=2024b header.b=K043WB+2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    arc=pass (i=2 spf=pass spfdomain=mail.provable.dev dkim=pass dkdomain=mail.provable.dev dmarc=pass fromdomain=mail.provable.dev);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    spf=pass (google.com: domain of thelaurel.bot+caf_=seth.one.info=gmail.com@gmail.com designates 209.85.220.41 as permitted sender) smtp.mailfrom=&quot;thelaurel.bot+caf_=seth.one.info=gmail.com@gmail.com&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dmarc=pass (p=REJECT sp=REJECT dis=NONE) header.from=mail.provable.dev;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dara=pass header.i=@gmail.com</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="arc-message-signature">ARC-Message-Signature<a href="#arc-message-signature" class="hash-link" aria-label="Direct link to ARC-Message-Signature" title="Direct link to ARC-Message-Signature">​</a></h3>
<ul>
<li><a href="https://datatracker.ietf.org/doc/html/rfc8617#section-4.1.2" target="_blank" rel="noopener noreferrer">https://datatracker.ietf.org/doc/html/rfc8617#section-4.1.2</a></li>
</ul>
<table><thead><tr><th>Field</th><th>Description</th><th>Example</th><th>Required</th></tr></thead><tbody><tr><td><code>i</code></td><td>ARC instance number. Must match corresponding ARC-Seal and ARC-Authentication-Results headers.</td><td><code>i=1</code></td><td>Yes</td></tr><tr><td><code>a</code></td><td>Signing algorithm used. Typically RSA or Ed25519 with a hash function.</td><td><code>a=rsa-sha256</code></td><td>Yes</td></tr><tr><td><code>c</code></td><td>Canonicalization algorithm for headers/body.</td><td><code>c=relaxed/relaxed</code></td><td>No (default: <code>simple/simple</code>)</td></tr><tr><td><code>d</code></td><td>Domain of the signer (signing domain).</td><td><code>d=example.org</code></td><td>Yes</td></tr><tr><td><code>s</code></td><td>Selector used to locate the public key in DNS.</td><td><code>s=brisbane</code></td><td>Yes</td></tr><tr><td><code>t</code></td><td>Signing timestamp (Unix seconds since epoch).</td><td><code>t=1610000000</code></td><td>No</td></tr><tr><td><code>h</code></td><td>List of signed headers, in the order they were signed.</td><td><code>h=from:to:subject:date</code></td><td>Yes</td></tr><tr><td><code>bh</code></td><td>Body hash (base64 of hash of canonicalized body).</td><td><code>bh=abcdefg...=</code></td><td>Yes</td></tr><tr><td><code>b</code></td><td>Signature itself (base64). Must be empty (<code>b=</code>) at time of signing.</td><td><code>b=abc123...</code></td><td>Yes</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="h-signed-headers-1"><code>h=</code> signed headers<a href="#h-signed-headers-1" class="hash-link" aria-label="Direct link to h-signed-headers-1" title="Direct link to h-signed-headers-1">​</a></h3>
<ul>
<li>required: <code>From</code></li>
<li>recommended: cover sender&#x27;s DKIM signature context; e.g. <code>From:To:Subject:Date:Message-ID:DKIM-Signature:Content-Type:Content-Transfer-Encoding:MIME-Version</code></li>
</ul>
<div class="language-email codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-email codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ARC-Message-Signature: i=3;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    a=rsa-sha256;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c=relaxed/relaxed;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    d=google.com;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    s=arc-20240605;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    h=content-transfer-encoding:mime-version:user-agent:date:message-id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        :subject:to:from:dkim-signature:dkim-signature:delivered-to;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    bh=4fWAjR8dybJoJ7oc+ua358Qnylv7LASFrox6UiJwQ8g=;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fh=Ml91QZNjOUBF4lPxdodEISvnG8cKMzALenqeNxoWqdI=;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    b=VEGNq275dIibd6+54GYZnP2dIHqFiGkAwALj/FA4hw7weJGTiFvfcb/O7p20PPWbUY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        isM3m4twYpknpID3hRN/euJJNWqj4VgclnJST3nQ+F0WgfwBCOl/wuVJbu9pO9vgJAY7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        WglNuiona7FL0Rlwp+KGHllLbR5CA0pak3s9E+OI3fhZya9/v5Gldis8vzsyfOiCnGta</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        5IYVB42Mgdi+tS2SaUaHqPUL+g9eo2hnca56CTkEieuOZcLFDcCOHQTZol4n8ti5aiiI</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        UB2EKnu+PC1JX7Tm2MYYBbIRZhuB9OF2TQat13rr8Hph3I1/cupScIWFRr/8Hkh4PP0q</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        9kUw==;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dara=google.com</span><br></span></code></pre></div></div>
<ul>
<li>cryptographically similar to <code>DKIM-Signature</code>, but the signed content has some differences.</li>
</ul>
<p>Captures and cryptographically preserves the message’s authentication state (headers and body) as received by an intermediate system (like a forwarder or mailing list), before it modifies or relays the message.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="arc-seal">ARC-Seal<a href="#arc-seal" class="hash-link" aria-label="Direct link to ARC-Seal" title="Direct link to ARC-Seal">​</a></h3>
<ul>
<li><a href="https://datatracker.ietf.org/doc/html/rfc8617#section-4.1.3" target="_blank" rel="noopener noreferrer">https://datatracker.ietf.org/doc/html/rfc8617#section-4.1.3</a></li>
</ul>
<table><thead><tr><th>Field</th><th>Description</th><th>Example</th><th>Required</th></tr></thead><tbody><tr><td><code>i</code></td><td>ARC instance number. Must match the corresponding <code>i=</code> in ARC-Authentication-Results and ARC-Message-Signature.</td><td><code>i=1</code></td><td>Yes</td></tr><tr><td><code>a</code></td><td>Algorithm used to generate the signature. Format: <code>&lt;algorithm&gt;-&lt;hash&gt;</code>.</td><td><code>a=rsa-sha256</code></td><td>Yes</td></tr><tr><td><code>d</code></td><td>Domain of the sealing entity (signer). Used with <code>s=</code> to retrieve the public key.</td><td><code>d=example.org</code></td><td>Yes</td></tr><tr><td><code>s</code></td><td>Selector used to locate the public key in DNS.</td><td><code>s=selector1</code></td><td>Yes</td></tr><tr><td><code>t</code></td><td>Signing timestamp (seconds since epoch).</td><td><code>t=1650000000</code></td><td>Yes</td></tr><tr><td><code>cv</code></td><td>Chain validation result for previous ARC sets. Values: <code>none</code>, <code>pass</code>, or <code>fail</code>.</td><td><code>cv=none</code></td><td>Yes</td></tr><tr><td><code>b</code></td><td>Signature value (base64-encoded). Empty (<code>b=</code>) when computing the hash.</td><td><code>b=abc123...</code></td><td>Yes</td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="cv">CV<a href="#cv" class="hash-link" aria-label="Direct link to CV" title="Direct link to CV">​</a></h4>
<table><thead><tr><th>Result</th><th>Description</th></tr></thead><tbody><tr><td>none</td><td>this is the first ARC set (i=1)</td></tr><tr><td>pass</td><td>all previous ARC sets validated</td></tr><tr><td>fail</td><td>if any prior ARC set failed</td></tr></tbody></table>
<div class="language-email codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-email codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ARC-Seal: i=3;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    a=rsa-sha256;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    t=1749589924;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cv=pass;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    d=google.com;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    s=arc-20240605;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    b=k/DDEvhaKSwq1fjWM0FrkW5lbFEVRHln8sdi0ExNdxC5DX2e6Wcc+yDxxesyjpccS/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        H8f5Ii2NnZShlTB37lgzP0s8knWd0sLnqorv/EM9DaCU/jRPwcPN51k4TOdMZqxzCzUy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        MHPNZzTN1o4XomdeC2EP2gw90XdaYhzTlmwR6F4uRdU42uPTPfAxHQp7muQSqez8ptF+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        GC641X6SE9SrCMNdakyj14W85fhc6rRvTzf8itaD1Rl3W3BoYjulSGVoRSYWS16He3uT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        l6YR7/0sc0tAKKhLYdkwesc81qo65crK6Qc/4F3Xq1iS88+kDc9kqizrg0lT++PNfFgO</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        BC0w==</span><br></span></code></pre></div></div>
<ul>
<li>the canonicalization for ARC-Seal is always relaxed (c= is not specified).</li>
<li>ARC-Seal signs over:<!-- -->
<ul>
<li>the current ARC-Authentication-Results</li>
<li>the current ARC-Message-Signature</li>
<li>all prior ARC-Seals (not including the current one)</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="headers">Headers<a href="#headers" class="hash-link" aria-label="Direct link to Headers" title="Direct link to Headers">​</a></h2>
<ul>
<li>topmost headers are most recent</li>
<li><a href="https://www.iana.org/assignments/message-headers/message-headers.xhtml" target="_blank" rel="noopener noreferrer">https://www.iana.org/assignments/message-headers/message-headers.xhtml</a></li>
<li>header formatting: <a href="https://datatracker.ietf.org/doc/html/rfc5322#section-2.2.3" target="_blank" rel="noopener noreferrer">https://datatracker.ietf.org/doc/html/rfc5322#section-2.2.3</a> (Long header fields folding)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="from"><code>From</code><a href="#from" class="hash-link" aria-label="Direct link to from" title="Direct link to from">​</a></h3>
<ul>
<li>RFC: <a href="https://datatracker.ietf.org/doc/html/rfc5322" target="_blank" rel="noopener noreferrer">RFC 5322</a></li>
<li>Purpose: Specifies the author of the message (the visible sender).</li>
<li>Set by: Mail User Agent (MUA) or sender.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="to"><code>To</code><a href="#to" class="hash-link" aria-label="Direct link to to" title="Direct link to to">​</a></h3>
<ul>
<li>RFC: <a href="https://datatracker.ietf.org/doc/html/rfc5322" target="_blank" rel="noopener noreferrer">RFC 5322</a></li>
<li>Purpose: Specifies the primary recipient(s) of the message.</li>
<li>Set by: Sender or email client.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="subject"><code>Subject</code><a href="#subject" class="hash-link" aria-label="Direct link to subject" title="Direct link to subject">​</a></h3>
<ul>
<li>RFC: <a href="https://datatracker.ietf.org/doc/html/rfc5322" target="_blank" rel="noopener noreferrer">RFC 5322</a></li>
<li>Purpose: Provides a summary or title of the message content.</li>
<li>Set by: Sender.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="date"><code>Date</code><a href="#date" class="hash-link" aria-label="Direct link to date" title="Direct link to date">​</a></h3>
<ul>
<li>RFC: <a href="https://datatracker.ietf.org/doc/html/rfc5322" target="_blank" rel="noopener noreferrer">RFC 5322</a></li>
<li>Purpose: Indicates the date and time at which the message was composed.</li>
<li>Set by: Sending mail client.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="message-id"><code>Message-ID</code><a href="#message-id" class="hash-link" aria-label="Direct link to message-id" title="Direct link to message-id">​</a></h3>
<ul>
<li>RFC: <a href="https://datatracker.ietf.org/doc/html/rfc5322" target="_blank" rel="noopener noreferrer">RFC 5322</a></li>
<li>Purpose: Provides a unique identifier for the message for threading and deduplication.</li>
<li>Set by: Sending MUA or mail server.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="reply-to"><code>Reply-To</code><a href="#reply-to" class="hash-link" aria-label="Direct link to reply-to" title="Direct link to reply-to">​</a></h3>
<ul>
<li>RFC: <a href="https://datatracker.ietf.org/doc/html/rfc5322" target="_blank" rel="noopener noreferrer">RFC 5322</a></li>
<li>Purpose: Indicates an alternate address for replies.</li>
<li>Set by: Sender.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="sender"><code>Sender</code><a href="#sender" class="hash-link" aria-label="Direct link to sender" title="Direct link to sender">​</a></h3>
<ul>
<li>RFC: <a href="https://datatracker.ietf.org/doc/html/rfc5322" target="_blank" rel="noopener noreferrer">RFC 5322</a></li>
<li>Purpose: Identifies the actual sender when From is a group or different role.</li>
<li>Set by: Sender.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="mime-version"><code>MIME-Version</code><a href="#mime-version" class="hash-link" aria-label="Direct link to mime-version" title="Direct link to mime-version">​</a></h3>
<ul>
<li>RFC: <a href="https://datatracker.ietf.org/doc/html/rfc2045" target="_blank" rel="noopener noreferrer">RFC 2045</a></li>
<li>Purpose: Indicates that the message uses MIME formatting.</li>
<li>Set by: Mail client.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="content-type"><code>Content-Type</code><a href="#content-type" class="hash-link" aria-label="Direct link to content-type" title="Direct link to content-type">​</a></h3>
<ul>
<li>RFC: <a href="https://datatracker.ietf.org/doc/html/rfc2045" target="_blank" rel="noopener noreferrer">RFC 2045</a></li>
<li>Purpose: Specifies the media type of the message body (e.g., text/plain, multipart).</li>
<li>Set by: Mail client.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="content-transfer-encoding"><code>Content-Transfer-Encoding</code><a href="#content-transfer-encoding" class="hash-link" aria-label="Direct link to content-transfer-encoding" title="Direct link to content-transfer-encoding">​</a></h3>
<ul>
<li>RFC: <a href="https://datatracker.ietf.org/doc/html/rfc2045" target="_blank" rel="noopener noreferrer">RFC 2045</a></li>
<li>Purpose: Indicates encoding used for the body content (e.g., base64, quoted-printable).</li>
<li>Set by: Mail client.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="delivered-to"><code>Delivered-To</code><a href="#delivered-to" class="hash-link" aria-label="Direct link to delivered-to" title="Direct link to delivered-to">​</a></h3>
<ul>
<li>RFC: Not standardized in an RFC, but widely used.</li>
<li>Purpose: Indicates the final mailbox address where the message was delivered.</li>
<li>Set by: The receiving mail server.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="received"><code>Received</code><a href="#received" class="hash-link" aria-label="Direct link to received" title="Direct link to received">​</a></h3>
<ul>
<li>RFC: <a href="https://datatracker.ietf.org/doc/html/rfc5321" target="_blank" rel="noopener noreferrer">https://datatracker.ietf.org/doc/html/rfc5321</a>, <a href="https://datatracker.ietf.org/doc/html/rfc5322" target="_blank" rel="noopener noreferrer">https://datatracker.ietf.org/doc/html/rfc5322</a></li>
<li>Purpose: Tracks the path an email took from the sender to the recipient by listing each mail server that processed it.</li>
<li>Set by: Each mail server in the delivery chain.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="return-path"><code>Return-Path</code><a href="#return-path" class="hash-link" aria-label="Direct link to return-path" title="Direct link to return-path">​</a></h3>
<ul>
<li>RFC: <a href="https://datatracker.ietf.org/doc/html/rfc5321#section-4.4" target="_blank" rel="noopener noreferrer">https://datatracker.ietf.org/doc/html/rfc5321#section-4.4</a></li>
<li>Purpose: Specifies the return address for bounced messages (MAIL FROM in SMTP).</li>
<li>Set by: The final mail server upon delivery.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="received-spf"><code>Received-SPF</code><a href="#received-spf" class="hash-link" aria-label="Direct link to received-spf" title="Direct link to received-spf">​</a></h3>
<ul>
<li>RFC: <a href="https://datatracker.ietf.org/doc/html/rfc7208#section-9.1" target="_blank" rel="noopener noreferrer">https://datatracker.ietf.org/doc/html/rfc7208#section-9.1</a></li>
<li>Purpose: Indicates the result of SPF (Sender Policy Framework) evaluation.</li>
<li>Set by: The receiving server.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="authentication-results"><code>Authentication-Results</code><a href="#authentication-results" class="hash-link" aria-label="Direct link to authentication-results" title="Direct link to authentication-results">​</a></h3>
<ul>
<li>RFC: <a href="https://datatracker.ietf.org/doc/html/rfc8601" target="_blank" rel="noopener noreferrer">https://datatracker.ietf.org/doc/html/rfc8601</a></li>
<li>Purpose: Records the results of authentication checks like SPF, DKIM, and DMARC.</li>
<li>Set by: Receiving server which does the authentication checks.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="dkim-signature"><code>DKIM-Signature</code><a href="#dkim-signature" class="hash-link" aria-label="Direct link to dkim-signature" title="Direct link to dkim-signature">​</a></h3>
<ul>
<li>RFC: <a href="https://datatracker.ietf.org/doc/html/rfc6376" target="_blank" rel="noopener noreferrer">RFC 6376</a></li>
<li>Purpose: Contains the cryptographic signature and parameters for DKIM verification.</li>
<li>Set by: Signing domain’s outgoing SMTP server.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="arc-seal-1"><code>ARC-Seal</code><a href="#arc-seal-1" class="hash-link" aria-label="Direct link to arc-seal-1" title="Direct link to arc-seal-1">​</a></h3>
<ul>
<li>RFC: <a href="https://datatracker.ietf.org/doc/html/rfc8617#section-4.1.3" target="_blank" rel="noopener noreferrer">RFC 8617</a></li>
<li>Purpose: Protects the ARC chain’s integrity and validity status.</li>
<li>Set by: Intermediary forwarding server participating in ARC.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="arc-message-signature-1"><code>ARC-Message-Signature</code><a href="#arc-message-signature-1" class="hash-link" aria-label="Direct link to arc-message-signature-1" title="Direct link to arc-message-signature-1">​</a></h3>
<ul>
<li>RFC: <a href="https://datatracker.ietf.org/doc/html/rfc8617#section-4.1.2" target="_blank" rel="noopener noreferrer">RFC 8617</a></li>
<li>Purpose: Signs the original message content and headers at the ARC step.</li>
<li>Set by: ARC-aware forwarder.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="arc-authentication-results-1"><code>ARC-Authentication-Results</code><a href="#arc-authentication-results-1" class="hash-link" aria-label="Direct link to arc-authentication-results-1" title="Direct link to arc-authentication-results-1">​</a></h3>
<ul>
<li>RFC: <a href="https://datatracker.ietf.org/doc/html/rfc8617#section-4.1.1" target="_blank" rel="noopener noreferrer">RFC 8617</a></li>
<li>Purpose: Captures the authentication results (SPF, DKIM, DMARC) of the original message at the forwarding server.</li>
<li>Set by: Forwarding server participating in ARC.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="envelope">Envelope<a href="#envelope" class="hash-link" aria-label="Direct link to Envelope" title="Direct link to Envelope">​</a></h2>
<p>The IMAP Envelope is extracted from the SMTP transaction metadata when the email is received by the server.</p>
<table><thead><tr><th>Field</th><th>Source</th><th>Example</th></tr></thead><tbody><tr><td><code>ENVELOPE.From</code></td><td>From the SMTP <code>MAIL FROM</code></td><td><code>MAIL FROM:&lt;sender@example.com&gt;</code></td></tr><tr><td><code>ENVELOPE.To</code></td><td>From the SMTP <code>RCPT TO</code></td><td><code>RCPT TO:&lt;recipient@example.com&gt;</code></td></tr><tr><td><code>ENVELOPE.Subject</code></td><td>From the message headers</td><td><code>Subject:</code> header</td></tr><tr><td><code>ENVELOPE.Sender</code></td><td>From headers, fallback logic</td><td><code>Sender:</code> or <code>From:</code> header</td></tr><tr><td><code>ENVELOPE.Date</code></td><td>From <code>Date:</code> header</td><td></td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="sending-an-email">Sending an Email<a href="#sending-an-email" class="hash-link" aria-label="Direct link to Sending an Email" title="Direct link to Sending an Email">​</a></h2>
<ul>
<li><code>MTA</code>: Mail Transfer Agent, responsible for sending, receiving, and routing email messages between email servers using the SMTP (Simple Mail Transfer Protocol).</li>
<li><code>MDA</code>: Mail Delivery Agent, responsible delivery of e-mail messages to a local recipient&#x27;s mailbox</li>
<li><code>MUA</code>: Mail User Agent, the email client.</li>
</ul>
<!-- -->
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="automatic-forwarding-with-arc-support">Automatic Forwarding with ARC support<a href="#automatic-forwarding-with-arc-support" class="hash-link" aria-label="Direct link to Automatic Forwarding with ARC support" title="Direct link to Automatic Forwarding with ARC support">​</a></h2>
<ul>
<li>forwards an email without changing its original headers, through a succession of mail servers, where each time the email is processed, an ARC set is added.</li>
<li>not to be mistaken by the manual &quot;forward&quot; action that a normal user can use. Unlike the manual &quot;forward&quot;, the automatic forwarding does not change the email&#x27;s body, subject and headers.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="unchanged-headers">Unchanged Headers<a href="#unchanged-headers" class="hash-link" aria-label="Direct link to Unchanged Headers" title="Direct link to Unchanged Headers">​</a></h3>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">From, To, Subject,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Message-Id, Date,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">User-Agent, Mime-Version,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Content-Type, Content-Transfer-Encoding,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DKIM-Signature (original)</span><br></span></code></pre></div></div>
<ul>
<li>same body (and <code>bh</code> body hash)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="added-headers">Added Headers<a href="#added-headers" class="hash-link" aria-label="Direct link to Added Headers" title="Direct link to Added Headers">​</a></h3>
<ul>
<li>for each MTA hop where a message is received from another MTA:</li>
</ul>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Received</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Received-SPF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Received</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Return-Path</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ARC-Authentication-Results: i=x;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ARC-Message-Signature: i=x;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ARC-Seal: i=x;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Delivered-To</span><br></span></code></pre></div></div>
<ul>
<li>MTA&#x27;s receiving an email from a MUA, to be forwarded, may also add ARC headers!</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="example-gmail-automatic-server-side-forwarding-with-arc-support">Example: Gmail automatic (server-side) forwarding with ARC support<a href="#example-gmail-automatic-server-side-forwarding-with-arc-support" class="hash-link" aria-label="Direct link to Example: Gmail automatic (server-side) forwarding with ARC support" title="Direct link to Example: Gmail automatic (server-side) forwarding with ARC support">​</a></h3>
<table><thead><tr><th>ARC Set <code>i=</code></th><th>Who Added It</th><th>Why It Was Added</th></tr></thead><tbody><tr><td><code>1</code></td><td><strong>Receiver MTA receiving from <code>mail.provable.dev</code></strong></td><td>Receiver MTA adds ARC headers (starts the chain)</td></tr><tr><td><code>2</code></td><td><strong>Sending MTA receiving from <code>thelaurel.bot@gmail.com</code> MUA</strong></td><td>MTA prepares for forwarding and adds another ARC set</td></tr><tr><td><code>3</code></td><td><strong>Receiver MTA for <code>seth.one.info@gmail.com</code></strong></td><td>Receiver MTA adds ARC headers</td></tr></tbody></table>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Delivered-To: seth.one.info@gmail.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Received: by 2002:a05:7022:68aa:b0:9b:65ec:421a with SMTP id cm42csp2343619dlb;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Tue, 10 Jun 2025 14:12:05 -0700 (PDT)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X-Forwarded-Encrypted: i=4; AJvYcCVxh8PFglGFqOAP+AsLsh/f3ftGU5tylg0uHg8ZsqaSMFRQYWNrLE3Tp5rvRf5ucX1jjvHcw8HSS89TgMVP@gmail.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X-Received: by 2002:a17:90b:5404:b0:311:a623:676c with SMTP id 98e67ed59e1d1-313af243c3bmr1398936a91.27.1749589924825;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Tue, 10 Jun 2025 14:12:04 -0700 (PDT)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ARC-Seal: i=3; a=rsa-sha256; t=1749589924; cv=pass;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        d=google.com; s=arc-20240605;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        b=k/DDEvhaKSwq1fjWM0FrkW5lbFEVRHln8sdi0ExNdxC5DX2e6Wcc+yDxxesyjpccS/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         H8f5Ii2NnZShlTB37lgzP0s8knWd0sLnqorv/EM9DaCU/jRPwcPN51k4TOdMZqxzCzUy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         MHPNZzTN1o4XomdeC2EP2gw90XdaYhzTlmwR6F4uRdU42uPTPfAxHQp7muQSqez8ptF+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         GC641X6SE9SrCMNdakyj14W85fhc6rRvTzf8itaD1Rl3W3BoYjulSGVoRSYWS16He3uT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         l6YR7/0sc0tAKKhLYdkwesc81qo65crK6Qc/4F3Xq1iS88+kDc9kqizrg0lT++PNfFgO</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         BC0w==</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ARC-Message-Signature: i=3; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20240605;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        h=content-transfer-encoding:mime-version:user-agent:date:message-id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         :subject:to:from:dkim-signature:dkim-signature:delivered-to;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bh=4fWAjR8dybJoJ7oc+ua358Qnylv7LASFrox6UiJwQ8g=;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fh=Ml91QZNjOUBF4lPxdodEISvnG8cKMzALenqeNxoWqdI=;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        b=VEGNq275dIibd6+54GYZnP2dIHqFiGkAwALj/FA4hw7weJGTiFvfcb/O7p20PPWbUY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         isM3m4twYpknpID3hRN/euJJNWqj4VgclnJST3nQ+F0WgfwBCOl/wuVJbu9pO9vgJAY7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         WglNuiona7FL0Rlwp+KGHllLbR5CA0pak3s9E+OI3fhZya9/v5Gldis8vzsyfOiCnGta</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         5IYVB42Mgdi+tS2SaUaHqPUL+g9eo2hnca56CTkEieuOZcLFDcCOHQTZol4n8ti5aiiI</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         UB2EKnu+PC1JX7Tm2MYYBbIRZhuB9OF2TQat13rr8Hph3I1/cupScIWFRr/8Hkh4PP0q</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         9kUw==;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        dara=google.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ARC-Authentication-Results: i=3; mx.google.com;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       dkim=neutral (no key) header.i=@mail.provable.dev header.s=2024a;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       dkim=pass header.i=@mail.provable.dev header.s=2024b header.b=K043WB+2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       arc=pass (i=2 spf=pass spfdomain=mail.provable.dev dkim=pass dkdomain=mail.provable.dev dmarc=pass fromdomain=mail.provable.dev);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       spf=pass (google.com: domain of thelaurel.bot+caf_=seth.one.info=gmail.com@gmail.com designates 209.85.220.41 as permitted sender) smtp.mailfrom=&quot;thelaurel.bot+caf_=seth.one.info=gmail.com@gmail.com&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       dmarc=pass (p=REJECT sp=REJECT dis=NONE) header.from=mail.provable.dev;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       dara=pass header.i=@gmail.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Return-Path: &lt;thelaurel.bot+caf_=seth.one.info=gmail.com@gmail.com&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Received: from mail-sor-f41.google.com (mail-sor-f41.google.com. [209.85.220.41])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        by mx.google.com with SMTPS id 98e67ed59e1d1-3134b0d75c5sor6293160a91.5.2025.06.10.14.12.04</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for &lt;seth.one.info@gmail.com&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        (Google Transport Security);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Tue, 10 Jun 2025 14:12:04 -0700 (PDT)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Received-SPF: pass (google.com: domain of thelaurel.bot+caf_=seth.one.info=gmail.com@gmail.com designates 209.85.220.41 as permitted sender) client-ip=209.85.220.41;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Authentication-Results: mx.google.com;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       dkim=neutral (no key) header.i=@mail.provable.dev header.s=2024a;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       dkim=pass header.i=@mail.provable.dev header.s=2024b header.b=K043WB+2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       arc=pass (i=2 spf=pass spfdomain=mail.provable.dev dkim=pass dkdomain=mail.provable.dev dmarc=pass fromdomain=mail.provable.dev);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       spf=pass (google.com: domain of thelaurel.bot+caf_=seth.one.info=gmail.com@gmail.com designates 209.85.220.41 as permitted sender) smtp.mailfrom=&quot;thelaurel.bot+caf_=seth.one.info=gmail.com@gmail.com&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       dmarc=pass (p=REJECT sp=REJECT dis=NONE) header.from=mail.provable.dev;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       dara=pass header.i=@gmail.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ARC-Seal: i=2; a=rsa-sha256; t=1749589924; cv=pass;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        d=google.com; s=arc-20240605;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        b=PouceSL2DqOihx6kLx+r9iuch/opZ8mVFCT+4tXOP74GLkG2RcfTWKb04BU93eggDN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         loMcaG+T9vCo7g1PnSUr4EuzLRW3BwGek4t3LHBKp4u7U3M0aY2X1bGmnz3EqKe/V9gq</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         7zv+ExdakSyHwszZU2fOwBEPW1KKOvdILiMkhNLepgX0lzioJ9zJnBDvKhDU3ZxPcbWB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         vOmNNTX8VH9seQaqgVKh5sqtpyvPYT4mlVAYURZTUNYOZe7RD7yUygIxgyjyvIbDNRN3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         kin4YzCEHL2vsnYFNr1ZnuKyOMF0RBm9xNpiAIgQt33ClS4iLCzTSiQKIOCToWrWJaHQ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         bYdg==</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ARC-Message-Signature: i=2; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20240605;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        h=content-transfer-encoding:mime-version:user-agent:date:message-id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         :subject:to:from:dkim-signature:dkim-signature:delivered-to;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bh=4fWAjR8dybJoJ7oc+ua358Qnylv7LASFrox6UiJwQ8g=;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fh=Ml91QZNjOUBF4lPxdodEISvnG8cKMzALenqeNxoWqdI=;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        b=Hx3YZqrTC2sXvj25ntj9xc3nBMaYfOwJZQV/SG86UJirOs+P3uEcb1cqtFrSJM1BEQ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         YFTzYSdQDuGkNzVSKGqP0Vd/SEJZH7WyLRv7KL4ZXaemGu072mnfr8KScHYqoo0Jh/68</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         O24YBOyLqnhi6LmCrbCTNasROMQjmkYeH8CFxw8e3beTzurVWtzoRbtw0SSdaLhlCX8M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         hPR7bKy1xwUqpIUdzoXGhjMyvvdJjGWVoGX8R5ouHrD+/sGL/yUsoTE4nEUW8Os2L4cB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         vCq7VGvwOTEYc8h++m50bsix5PIWne06Lu51QVfIIoocy1bIesjg5OEgO3LdEVbXBZyG</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         /28g==;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        dara=google.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ARC-Authentication-Results: i=2; mx.google.com;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       dkim=neutral (no key) header.i=@mail.provable.dev header.s=2024a;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       dkim=pass header.i=@mail.provable.dev header.s=2024b header.b=K043WB+2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       spf=pass (google.com: domain of test@mail.provable.dev designates 85.215.130.119 as permitted sender) smtp.mailfrom=test@mail.provable.dev;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       dmarc=pass (p=REJECT sp=REJECT dis=NONE) header.from=mail.provable.dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        d=1e100.net; s=20230601; t=1749589924; x=1750194724;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        h=content-transfer-encoding:mime-version:user-agent:date:message-id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         :subject:to:from:dkim-signature:dkim-signature:delivered-to</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         :x-forwarded-for:x-forwarded-to:x-gm-message-state:from:to:cc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         :subject:date:message-id:reply-to;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bh=4fWAjR8dybJoJ7oc+ua358Qnylv7LASFrox6UiJwQ8g=;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        b=A5W976h4O/CG/P73lVKQhrPQ9m4Ck8gtOXsdq5r8rYC96rVKE2+l9fxiDW9EyP8Fw2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         cC/beXjlqXq2x0+7Slgz69xswg7YgQnbOqKNeuw2lnVySpVzm37ofzJxYJc0DlOd8GZf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         2BclsyFeawJdBw9ShN8hML5lFuSnB/c5BKMUqnZPL2dv2Nn+mecGSGupNKUozgEQoGUB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         33FZSuu/OJXq80W4g1Zw6f9OI4N5GryuDvkRcMEosr8FXs1oK49LyEL+BLBOkob1ZSq1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         B9gNHndx1UWdQnAeRugVnVMLbc55g5ljjxPFN/apaXpJRf4d9V44xw0EfXcmxxY95hgN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         v+bQ==</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X-Forwarded-Encrypted: i=2; AJvYcCVzwbjjEAn5P65ODzz5UJic0iiOWnQHTvzj+23T52cihhu/6J1FehAdcICTsY1M7IXbPZnrUSFw65UJyBVB@gmail.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X-Gm-Message-State: AOJu0YwiMmE5+S3vAQj289iAzNuPgjbJqMI42CnVzMr66JItgosD727m +unReCJQNgqhYxwHtnnFQiQhBmE3/0ADm9XcB5G4XovduYB6KUD2S+/rrHuvOs5YuZcYZj++huL Hw2wxPRD5V8wimIXezGumI7/zoVPN+ZoTHKUfpnRc+QUrVT3ibavXbx1LCU63Pg==</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X-Received: by 2002:a17:90b:540c:b0:311:9c9a:58c5 with SMTP id 98e67ed59e1d1-313af142493mr1762856a91.12.1749589924287;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Tue, 10 Jun 2025 14:12:04 -0700 (PDT)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X-Forwarded-To: seth.one.info@gmail.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X-Forwarded-For: thelaurel.bot@gmail.com seth.one.info@gmail.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Delivered-To: thelaurel.bot@gmail.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Received: by 2002:a05:7300:6d24:b0:175:1578:60a4 with SMTP id n36csp3474650dyo;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Tue, 10 Jun 2025 14:12:02 -0700 (PDT)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X-Google-Smtp-Source: AGHT+IGwIyJJdBos2ffdx/X/IC6i7UKNrd9AfPlY7u8egXNfndrqa6B29sAySEG1UljObzr+iz+b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X-Received: by 2002:a05:6000:2210:b0:3a4:f55a:4ae2 with SMTP id ffacd0b85a97d-3a558ae65d0mr363669f8f.50.1749589922667;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Tue, 10 Jun 2025 14:12:02 -0700 (PDT)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ARC-Seal: i=1; a=rsa-sha256; t=1749589922; cv=none;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        d=google.com; s=arc-20240605;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        b=dS95Wj+Z/5+cuo9YJOHYkKM75GTGamBg6uPljF+TKJ/ooHPDasKA+szz6fxcsac21v</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         9xyEArJm5fxl4xAs2xHoL30nxbhr8UTZWbIFjLwRWuQrallGyaVVgEl8/muaI3vnty1P</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         k79jIFaYkdGmHGymYm0LcszSAF0Hws0Y9ojWnP5ENICQOxYWf9M0YWVmpVfov6BuNt0D</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         F7q+RTz0CaOvXQqQCymsRZFrwln9zPLBFXoJ8MjH3M3wDJKcvX7ymKY9BgJ+odvwyeKv</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         FLqaK0vu6JGqerHBOtAjbq4qtvG34IdS2qRtVJ+qG+IxJdufEaQi+HLp6StWUvoSBPwi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         /GCg==</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20240605;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        h=content-transfer-encoding:mime-version:user-agent:date:message-id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         :subject:to:from:dkim-signature:dkim-signature;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bh=4fWAjR8dybJoJ7oc+ua358Qnylv7LASFrox6UiJwQ8g=;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fh=kPQEZMPS3Hwz+5rPK66FFY2UWO38OU1FMnbjU+jALNQ=;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        b=Sx7U7BxxT/dDSF7NXPF2gMMWxgEDzVc97UB5qx4C9MVL/nJB9NS9yE3y71QOR6ehvh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         8hrToCspPAZk6G/HDDuhX9zs48FvpRgLf01dbtq656XG3SZFb0++0likj310jW/7kRIG</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         hWbWIJK95qwdMedBm4bkclpGCFauAgidblDf00nIdLd8yHTefYeuOFh3x9fYpUcD4sLh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         tHCpcVXgsjToEHKy+hgMQUzMfZs8mNKyL59x4wesN56wOMTKFdd245oysRqHPzkgnQak</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         77rmJVxo6GYb37/zp6mXjoZQ+BQHOg8bB8MGpzyZhjuwqbRrj/+EnMg0b0F6z4bSIlok</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         SDyg==;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        dara=google.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ARC-Authentication-Results: i=1; mx.google.com;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       dkim=neutral (no key) header.i=@mail.provable.dev header.s=2024a;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       dkim=pass header.i=@mail.provable.dev header.s=2024b header.b=K043WB+2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       spf=pass (google.com: domain of test@mail.provable.dev designates 85.215.130.119 as permitted sender) smtp.mailfrom=test@mail.provable.dev;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       dmarc=pass (p=REJECT sp=REJECT dis=NONE) header.from=mail.provable.dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Return-Path: &lt;test@mail.provable.dev&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Received: from mail.provable.dev (mail.provable.dev. [85.215.130.119])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        by mx.google.com with ESMTPS id ffacd0b85a97d-3a53244fc3asi7920677f8f.247.2025.06.10.14.12.02</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for &lt;thelaurel.bot@gmail.com&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        (version=TLS1_3 cipher=TLS_AES_128_GCM_SHA256 bits=128/128);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Tue, 10 Jun 2025 14:12:02 -0700 (PDT)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Received-SPF: pass (google.com: domain of test@mail.provable.dev designates 85.215.130.119 as permitted sender) client-ip=85.215.130.119;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Received: from mail.provable.dev by mail.provable.dev id n5-sNLLrTuZJYpcmGH8G1g for &lt;thelaurel.bot@gmail.com&gt;; 10 Jun 2025 21:12:02 +0000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DKIM-Signature: v=1; d=mail.provable.dev; s=2024a; i=test@mail.provable.dev; a=ed25519-sha256; t=1749589922; x=1749849122; h=From:To:Cc:Bcc:Reply-To: References:In-Reply-To:Subject:Date:Message-Id:Content-Type:From:To:Subject: Date:Message-Id:Content-Type; bh=4fWAjR8dybJoJ7oc+ua358Qnylv7LASFrox6UiJwQ8g=; b=7J39El5KDL4NPguv2fK3m7xm/F evJN9QFqECm90XGwfWnlqBEEjHteY/P28AJ5xwfenf08TdtBLIMes6PMZTBA==</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DKIM-Signature: v=1; d=mail.provable.dev; s=2024b; i=test@mail.provable.dev; a=rsa-sha256; t=1749589922; x=1749849122; h=From:To:Cc:Bcc:Reply-To: References:In-Reply-To:Subject:Date:Message-Id:Content-Type:From:To:Subject: Date:Message-Id:Content-Type; bh=4fWAjR8dybJoJ7oc+ua358Qnylv7LASFrox6UiJwQ8g=; b=K043WB+2sby57d3sihT+xRSou8 H2+XTKqUxrfBRaOa6q48hcUs7DVg9n+0bA6T7cAQYlNsc1MNoViH5ebdjYKigJepnwrh4CCGweJUZ plhBWUF2McU4Kgz8XaLyCt5ipots2aOLRG7yT0FkudXYBY2bnG64fbyQABf6LClIF9Gwuq8gNF5Mj YF+oZZCZdnsQnf/AT+qDYCjOgTbjoPosZDOypsHSu42/m12UsYEqAZsBrsqaFV1rmFLlpdWzQ8y41 dySACyWpRiVayzU5vFvfBkd/juhG94xlER9cs8RLE/oeFXqtOqq21HDUfqLp3koxqOeHTgmctN/0r BI+nuopA==</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">From: &lt;test@mail.provable.dev&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">To: &lt;thelaurel.bot@gmail.com&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Subject: Testing forwarding</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Message-Id: &lt;uaeCGNbn4n1NJX6igHstlA@mail.provable.dev&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Date: 10 Jun 2025 21:12:02 +0000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">User-Agent: moxwebmail/v0.0.10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MIME-Version: 1.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Content-Type: text/plain; charset=us-ascii</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Content-Transfer-Encoding: 7bit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Testing forwarding body</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="manual-forwarding">Manual Forwarding<a href="#manual-forwarding" class="hash-link" aria-label="Direct link to Manual Forwarding" title="Direct link to Manual Forwarding">​</a></h2>
<p>If a user wants to manually forward an email to another user, most of the original email is changed by the forwarding MUA &amp; MTA.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="changed-headers">Changed Headers<a href="#changed-headers" class="hash-link" aria-label="Direct link to Changed Headers" title="Direct link to Changed Headers">​</a></h3>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">From</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">To</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Date</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Message-ID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Subject</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Content-Type</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DKIM-Signature</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">References</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">In-Reply-To</span><br></span></code></pre></div></div>
<ul>
<li>changed email body (and therefore <code>bh</code> field)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="added-headers-by-receiving-mta">Added Headers by Receiving MTA<a href="#added-headers-by-receiving-mta" class="hash-link" aria-label="Direct link to Added Headers by Receiving MTA" title="Direct link to Added Headers by Receiving MTA">​</a></h3>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Delivered-To</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Received</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ARC-Seal: i=1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ARC-Message-Signature: i=1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ARC-Authentication-Results: i=1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Return-Path</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Received-SPF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Authentication-Results</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="original-email-information-in-the-forwarded-email">Original Email Information in the Forwarded Email<a href="#original-email-information-in-the-forwarded-email" class="hash-link" aria-label="Direct link to Original Email Information in the Forwarded Email" title="Direct link to Original Email Information in the Forwarded Email">​</a></h3>
<ul>
<li>the email body can contain a copy of the original email, with no way to prove that the content is the same as the original email</li>
<li><code>References</code> and <code>In-Reply-To</code> reference the original <code>Message-ID</code></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="example-gmail-manual-forward">Example: Gmail manual forward<a href="#example-gmail-manual-forward" class="hash-link" aria-label="Direct link to Example: Gmail manual forward" title="Direct link to Example: Gmail manual forward">​</a></h3>
<ul>
<li>instead of automatically forwarding the email from <code>thelaurel.bot</code> to <code>seth.info</code>, now we are manually forwarding it.</li>
</ul>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Delivered-To: seth.one.info@gmail.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Received: by 2002:a05:7022:68aa:b0:9b:65ec:421a with SMTP id cm42csp3414764dlb;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Thu, 12 Jun 2025 05:50:14 -0700 (PDT)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X-Received: by 2002:a17:902:e74b:b0:234:8ef1:aa7b with SMTP id d9443c01a7336-23641abca6bmr103950355ad.20.1749732614667;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Thu, 12 Jun 2025 05:50:14 -0700 (PDT)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ARC-Seal: i=1; a=rsa-sha256; t=1749732614; cv=none;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        d=google.com; s=arc-20240605;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        b=aYhU5pBdpFG0f0vGAA6NtU6KxRtMfsku2OL259C42A91ei+dhk4yjiYm+UmD3rj/Tf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         UfH2gptcsIil2fEdSm0Pfq+gEFBpz7/VoFkj874v2thK3lUl13SqWN8U14w/cawAdPfX</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         z49S7NyrqJN428aRaTe7Ld+RdBha0ZI0Qh3LwliO3f6J0C8JeshGjdqMGPxZsVxy/bvh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         ofCUHiXKsf5OfKSMcAY5v7DNSmxi14d9TIpb4Tra1XUw17lB2FkIu6cLd6aYAZxQEDsj</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         b9jemiaH+RbJt+d8XROIT7z+6OzF/k9wHypGcTEoZzVz/ZqfEynhDeAlAV0DHAR7J+te</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         oV1A==</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20240605;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        h=to:subject:message-id:date:from:in-reply-to:references:mime-version</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         :dkim-signature;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bh=zNnb+VkDrT/I3UU7kd/InOkFcj73kOvO3T1aNoOZoYk=;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fh=5EpvDt+ShiZGXW0fMSFmw2r+hZoF+7FPLlq4kibCHO8=;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        b=CcDxEBsvHWxkAGe2yXLV3lpC/60xFO8Kw7GLlkOM3DfMUpzD1G+mqWP6IU7+HCRVIu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         D/+T5R66MMPu46ZAWGFyJzMHqqMlDNpu23eBSOZepLTvewhidfBhYOsctwpixOx4yfG2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         N0p/T15Gj5cC60tSqhmAcxZNQuc+Z2t8onAGSDU5AiwkR0nxKYKqospV7kvdaHMAmcNh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         ZnjZLmXf1ilWIJqOgK34wx67qZwZz9k0QRiGIobjaXFeIfYms7OOeU9jRmnEK99L0d6f</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         sLm+ZHik5zvKCH7oEWhj0Vp9FvXFXnVJI21ksj32SZr2QjiOO+nf8dXVRyp+4+go8xEq</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         JDeA==;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        dara=google.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ARC-Authentication-Results: i=1; mx.google.com;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       dkim=pass header.i=@gmail.com header.s=20230601 header.b=&quot;O2Wz/L8j&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       spf=pass (google.com: domain of thelaurel.bot@gmail.com designates 209.85.220.41 as permitted sender) smtp.mailfrom=thelaurel.bot@gmail.com;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       dmarc=pass (p=NONE sp=QUARANTINE dis=NONE) header.from=gmail.com;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       dara=pass header.i=@gmail.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Return-Path: &lt;thelaurel.bot@gmail.com&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Received: from mail-sor-f41.google.com (mail-sor-f41.google.com. [209.85.220.41])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        by mx.google.com with SMTPS id d9443c01a7336-2364e6210e5sor9621785ad.7.2025.06.12.05.50.14</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for &lt;seth.one.info@gmail.com&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        (Google Transport Security);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Thu, 12 Jun 2025 05:50:14 -0700 (PDT)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Received-SPF: pass (google.com: domain of thelaurel.bot@gmail.com designates 209.85.220.41 as permitted sender) client-ip=209.85.220.41;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Authentication-Results: mx.google.com;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       dkim=pass header.i=@gmail.com header.s=20230601 header.b=&quot;O2Wz/L8j&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       spf=pass (google.com: domain of thelaurel.bot@gmail.com designates 209.85.220.41 as permitted sender) smtp.mailfrom=thelaurel.bot@gmail.com;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       dmarc=pass (p=NONE sp=QUARANTINE dis=NONE) header.from=gmail.com;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       dara=pass header.i=@gmail.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        d=gmail.com; s=20230601; t=1749732614; x=1750337414; dara=google.com;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        h=to:subject:message-id:date:from:in-reply-to:references:mime-version</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         :from:to:cc:subject:date:message-id:reply-to;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bh=zNnb+VkDrT/I3UU7kd/InOkFcj73kOvO3T1aNoOZoYk=;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        b=O2Wz/L8ji9CW7Xi56aiHmISB7v7KSkxzwmPulYvjzIblcABE6gWtMGUMdxQZV2R85T</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         Lk0kpgcra4Toqc7+oiRHaZgdMgcDG2jmbCRYmi9PsCJznqgZ0O0dj7aExCy+53kViMpn</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         msAiRElv2JaHrnx410S5kYQeouu+keYNrbpvLQJWTi3iM93Xhsjc3srOx/+4yhFd9oNs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         a+nm++bY6FB62joVIWbjjvxoNYHmiemuCXQ2FTRkO5GCvGx99NZwNNR+oAnCYfKAnb4B</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         69zwFhE8U0+w2pFMX2i7Mr32qlRLZrYOQ526SfFy9fiISKwAZ75VMflLWkVR3L//3Pge</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         PZ/w==</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        d=1e100.net; s=20230601; t=1749732614; x=1750337414;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        h=to:subject:message-id:date:from:in-reply-to:references:mime-version</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         :x-gm-message-state:from:to:cc:subject:date:message-id:reply-to;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bh=zNnb+VkDrT/I3UU7kd/InOkFcj73kOvO3T1aNoOZoYk=;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        b=TFi2UBqdfGNPUu10F3XefehWqhZ88vZGMFE0BL6aLU1WpvuN85YJe7GAJXjm8+Lz/x</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         6ltdE8ym2KX+KH8ekcQX+FWMJoAsuQCEGMt0jpBH4StdedpAgu8XfASOBaN3OwBQnERN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         hLmuWeS/O9AJfL2uXVUxl90z08wV/jPv0ft2cuejm4FKzgZ7hQcwWFwzjfwFMsHQnEOX</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         mxy0f8OBi1juDWjp8DAzYgj496uYIe7mj7K7PkDFFc+bPrZD0324brbghkI2R80Reo9T</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         5Sf/QWX1I4HojrxoeH0yQZAqAXTnrxw0Tbj6mvyRMl5IUg1dgJ+C0Ja7KjIG3BSknuIP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         WvHQ==</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X-Gm-Message-State: AOJu0YyTYc6vJwrOodmwCvIfqCle2QR3ZkVW50nfUBN4dkfon8zfxKNe iO9w+yJZ8zgI+VASC2RG7ncHo4+g2ooiy2tZdF+MDDapBIQvKcx94x+9jOdFNV0RyTYgqWIGjNE p3HAkjZqS+0m1JRPI4QSafRybgcqSZnw=</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X-Gm-Gg: ASbGncvGTP9jrvusurKQI+ss2xwMg4Rt756nzQ4gq49XmvJNgN9wqM7ot3tubKKABwX lEePhgwlF5/wFMpVOUcF1DN2CJEUk8WnCL90aMinnlkLSi9+FuoYRqbzlDzsraQ+PBtS3W1/RSp Cg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X-Google-Smtp-Source: AGHT+IEWOjQuMbHFCoiZ+Dy96L1cRht7F1FnbHPaINsVArFFOTvi56tBawfkKp7roH4U92M5uTo6HDx65ZFW5ac7YHs=</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X-Received: by 2002:a17:90b:438f:b0:312:e76f:5213 with SMTP id 98e67ed59e1d1-313af2034damr7893079a91.28.1749732611770; Thu, 12 Jun 2025 05:50:11 -0700 (PDT)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MIME-Version: 1.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">References: &lt;uaeCGNbn4n1NJX6igHstlA@mail.provable.dev&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">In-Reply-To: &lt;uaeCGNbn4n1NJX6igHstlA@mail.provable.dev&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">From: The Laurel Bot &lt;thelaurel.bot@gmail.com&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Date: Thu, 12 Jun 2025 14:50:00 +0200</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X-Gm-Features: AX0GCFsbpVmqrPm0J16GOtkAILje3vE9SR-iLhuhD2bFKlcqbDQ_IG5MwPYPTKU</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Message-ID: &lt;CANGBCcU3-rqvcwR_5EHFh3ZL3k46UgAFoUQ6v6BC5U1Q4DMi=w@mail.gmail.com&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Subject: Fwd: Testing forwarding</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">To: &quot;seth.one.info@gmail.com&quot; &lt;seth.one.info@gmail.com&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Content-Type: multipart/alternative; boundary=&quot;000000000000c6cc6806375f5e76&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--000000000000c6cc6806375f5e76</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Content-Type: text/plain; charset=&quot;UTF-8&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---------- Forwarded message ---------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">From: &lt;test@mail.provable.dev&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Date: Tue, 10 Jun 2025 at 23:12</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Subject: Testing forwarding</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">To: &lt;thelaurel.bot@gmail.com&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Testing forwarding body</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--000000000000c6cc6806375f5e76</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Content-Type: text/html; charset=&quot;UTF-8&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Content-Transfer-Encoding: quoted-printable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;div dir=3D&quot;ltr&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;div class=3D&quot;gmail_quote gmail_quote_container&quot;&gt;&lt;=</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">div dir=3D&quot;ltr&quot; class=3D&quot;gmail_attr&quot;&gt;---------- Forwarded message ---------=</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;br&gt;From: &lt;span dir=3D&quot;auto&quot;&gt;&amp;lt;&lt;a href=3D&quot;mailto:test@mail.provable.dev&quot;&gt;=</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">test@mail.provable.dev&lt;/a&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;Date: Tue, 10 Jun 2025 at 23:12&lt;br=</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt;Subject: Testing forwarding&lt;br&gt;To:  &amp;lt;&lt;a href=3D&quot;mailto:thelaurel.bot@gm=</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ail.com&quot;&gt;thelaurel.bot@gmail.com&lt;/a&gt;&amp;gt;&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;br&gt;Testing forwardin=</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">g body&lt;br&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/div&gt;&lt;/div&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--000000000000c6cc6806375f5e76--</span><br></span></code></pre></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/loredanacirstea/wasmx-docs/tree/main/docs/architecture/email.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/architecture/provable_email_forwarding"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Provable Email Forwarding</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#spf-sender-policy-framework" class="table-of-contents__link toc-highlight">SPF (Sender Policy Framework)</a></li><li><a href="#dkim-domainkeys-identified-mail" class="table-of-contents__link toc-highlight">DKIM (DomainKeys Identified Mail)</a><ul><li><a href="#required-dkim-signature-tags" class="table-of-contents__link toc-highlight">Required DKIM Signature Tags</a></li><li><a href="#optional-dkim-signature-tags" class="table-of-contents__link toc-highlight">Optional DKIM Signature Tags</a></li><li><a href="#h-signed-headers" class="table-of-contents__link toc-highlight"><code>h=</code> signed headers</a></li></ul></li><li><a href="#dmarc-domain-based-message-authentication-reporting-and-conformance" class="table-of-contents__link toc-highlight">DMARC (Domain-based Message Authentication, Reporting and Conformance)</a><ul><li><a href="#flow" class="table-of-contents__link toc-highlight">Flow</a></li></ul></li><li><a href="#arc-authenticated-received-chain" class="table-of-contents__link toc-highlight">ARC (Authenticated Received Chain)</a><ul><li><a href="#flow-1" class="table-of-contents__link toc-highlight">Flow</a></li><li><a href="#arc-authentication-results" class="table-of-contents__link toc-highlight">ARC-Authentication-Results</a></li><li><a href="#arc-message-signature" class="table-of-contents__link toc-highlight">ARC-Message-Signature</a></li><li><a href="#h-signed-headers-1" class="table-of-contents__link toc-highlight"><code>h=</code> signed headers</a></li><li><a href="#arc-seal" class="table-of-contents__link toc-highlight">ARC-Seal</a></li></ul></li><li><a href="#headers" class="table-of-contents__link toc-highlight">Headers</a><ul><li><a href="#from" class="table-of-contents__link toc-highlight"><code>From</code></a></li><li><a href="#to" class="table-of-contents__link toc-highlight"><code>To</code></a></li><li><a href="#subject" class="table-of-contents__link toc-highlight"><code>Subject</code></a></li><li><a href="#date" class="table-of-contents__link toc-highlight"><code>Date</code></a></li><li><a href="#message-id" class="table-of-contents__link toc-highlight"><code>Message-ID</code></a></li><li><a href="#reply-to" class="table-of-contents__link toc-highlight"><code>Reply-To</code></a></li><li><a href="#sender" class="table-of-contents__link toc-highlight"><code>Sender</code></a></li><li><a href="#mime-version" class="table-of-contents__link toc-highlight"><code>MIME-Version</code></a></li><li><a href="#content-type" class="table-of-contents__link toc-highlight"><code>Content-Type</code></a></li><li><a href="#content-transfer-encoding" class="table-of-contents__link toc-highlight"><code>Content-Transfer-Encoding</code></a></li><li><a href="#delivered-to" class="table-of-contents__link toc-highlight"><code>Delivered-To</code></a></li><li><a href="#received" class="table-of-contents__link toc-highlight"><code>Received</code></a></li><li><a href="#return-path" class="table-of-contents__link toc-highlight"><code>Return-Path</code></a></li><li><a href="#received-spf" class="table-of-contents__link toc-highlight"><code>Received-SPF</code></a></li><li><a href="#authentication-results" class="table-of-contents__link toc-highlight"><code>Authentication-Results</code></a></li><li><a href="#dkim-signature" class="table-of-contents__link toc-highlight"><code>DKIM-Signature</code></a></li><li><a href="#arc-seal-1" class="table-of-contents__link toc-highlight"><code>ARC-Seal</code></a></li><li><a href="#arc-message-signature-1" class="table-of-contents__link toc-highlight"><code>ARC-Message-Signature</code></a></li><li><a href="#arc-authentication-results-1" class="table-of-contents__link toc-highlight"><code>ARC-Authentication-Results</code></a></li></ul></li><li><a href="#envelope" class="table-of-contents__link toc-highlight">Envelope</a></li><li><a href="#sending-an-email" class="table-of-contents__link toc-highlight">Sending an Email</a></li><li><a href="#automatic-forwarding-with-arc-support" class="table-of-contents__link toc-highlight">Automatic Forwarding with ARC support</a><ul><li><a href="#unchanged-headers" class="table-of-contents__link toc-highlight">Unchanged Headers</a></li><li><a href="#added-headers" class="table-of-contents__link toc-highlight">Added Headers</a></li><li><a href="#example-gmail-automatic-server-side-forwarding-with-arc-support" class="table-of-contents__link toc-highlight">Example: Gmail automatic (server-side) forwarding with ARC support</a></li></ul></li><li><a href="#manual-forwarding" class="table-of-contents__link toc-highlight">Manual Forwarding</a><ul><li><a href="#changed-headers" class="table-of-contents__link toc-highlight">Changed Headers</a></li><li><a href="#added-headers-by-receiving-mta" class="table-of-contents__link toc-highlight">Added Headers by Receiving MTA</a></li><li><a href="#original-email-information-in-the-forwarded-email" class="table-of-contents__link toc-highlight">Original Email Information in the Forwarded Email</a></li><li><a href="#example-gmail-manual-forward" class="table-of-contents__link toc-highlight">Example: Gmail manual forward</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/overview/introduction">Overview</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/wasmX" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://discord.gg/8W5jeBke4f" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://x.com/lorecirstea" target="_blank" rel="noopener noreferrer" class="footer__link-item">X<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/loredanacirstea/wasmx-docs" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 wasmX. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>